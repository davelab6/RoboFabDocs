

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>robofab.objects.objectsBase &mdash; RoboFab 1.3.0a documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.3.0a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="RoboFab 1.3.0a documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">RoboFab 1.3.0a documentation</a> &raquo;</li>
          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for robofab.objects.objectsBase</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot; </span>

<span class="sd">====================</span>
<span class="sd">Robofab Base Classes</span>
<span class="sd">====================</span>

<span class="sd">These are base classes for Font, Glyph, Contour, Segment and Point objects. This defines the basic API that needs to be supported in RoboFab objects.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">generators</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">import</span> <span class="nn">ufoLib</span>
<span class="kn">from</span> <span class="nn">robofab</span> <span class="kn">import</span> <span class="n">RoboFabError</span>
<span class="kn">from</span> <span class="nn">fontTools.misc.arrayTools</span> <span class="kn">import</span> <span class="n">updateBounds</span><span class="p">,</span> <span class="n">pointInRect</span><span class="p">,</span> <span class="n">unionRect</span><span class="p">,</span> <span class="n">sectRect</span>
<span class="kn">from</span> <span class="nn">fontTools.pens.basePen</span> <span class="kn">import</span> <span class="n">AbstractPen</span>


<span class="c">#constants for dealing with segments, points and bPoints</span>
<span class="n">MOVE</span> <span class="o">=</span> <span class="s">&#39;move&#39;</span>
<span class="n">LINE</span> <span class="o">=</span> <span class="s">&#39;line&#39;</span>
<span class="n">CORNER</span> <span class="o">=</span> <span class="s">&#39;corner&#39;</span>
<span class="n">CURVE</span> <span class="o">=</span> <span class="s">&#39;curve&#39;</span>
<span class="n">QCURVE</span> <span class="o">=</span> <span class="s">&#39;qcurve&#39;</span>
<span class="n">OFFCURVE</span> <span class="o">=</span> <span class="s">&#39;offcurve&#39;</span>

<span class="n">DEGREE</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>



<span class="c"># the key for the postscript hint data stored in the UFO</span>
<span class="n">postScriptHintDataLibKey</span> <span class="o">=</span> <span class="s">&quot;org.robofab.postScriptHintData&quot;</span>

<span class="c"># from http://svn.typesupply.com/packages/fontMath/mathFunctions.py</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span>

<span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">v1</span> <span class="o">-</span> <span class="n">v2</span>

<span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">v</span> <span class="o">*</span> <span class="n">f</span>

<span class="k">def</span> <span class="nf">div</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">v</span> <span class="o">/</span> <span class="n">f</span>
	
<div class="viewcode-block" id="issequence"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.issequence">[docs]</a><span class="k">def</span> <span class="nf">issequence</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="s">&quot;Is x a sequence? We say it is if it has a __getitem__ method.&quot;</span>
	<span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;__getitem__&#39;</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="BasePostScriptHintValues"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptHintValues">[docs]</a><span class="k">class</span> <span class="nc">BasePostScriptHintValues</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Base class for postscript hinting information.</span>
<span class="sd">	&quot;&quot;&quot;</span>
		
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fromDict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;default&#39;</span><span class="p">])</span>
		
<div class="viewcode-block" id="BasePostScriptHintValues.getParent"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptHintValues.getParent">[docs]</a>	<span class="k">def</span> <span class="nf">getParent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;this method will be overwritten with a weakref if there is a parent.&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">None</span>
</div>
	<span class="k">def</span> <span class="nf">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="kn">import</span> <span class="nn">weakref</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		
<div class="viewcode-block" id="BasePostScriptHintValues.isEmpty"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptHintValues.isEmpty">[docs]</a>	<span class="k">def</span> <span class="nf">isEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Check all attrs and decide if they&#39;re all empty.&quot;&quot;&quot;</span>
		<span class="n">empty</span> <span class="o">=</span> <span class="bp">True</span>
		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
				<span class="n">empty</span> <span class="o">=</span> <span class="bp">False</span>
				<span class="k">break</span>
		<span class="k">return</span> <span class="n">empty</span>
</div>
<div class="viewcode-block" id="BasePostScriptHintValues.clear"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptHintValues.clear">[docs]</a>	<span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set all attributes to default / empty&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="p">:</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;default&#39;</span><span class="p">])</span>
		</div>
	<span class="k">def</span> <span class="nf">_loadFromLib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib</span><span class="p">):</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">postScriptHintDataLibKey</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fromDict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_saveToLib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib</span><span class="p">):</span>
		<span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">parent</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="n">hintsDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asDict</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">hintsDict</span><span class="p">:</span>
			<span class="n">lib</span><span class="p">[</span><span class="n">postScriptHintDataLibKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">hintsDict</span>

	<span class="k">def</span> <span class="nf">fromDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
	
	<span class="k">def</span> <span class="nf">asDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
				<span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> attribute not supported&quot;</span><span class="o">%</span><span class="n">name</span>
				<span class="k">continue</span>
			<span class="k">if</span> <span class="n">value</span><span class="p">:</span>
				<span class="n">d</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">d</span>
	
	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BasePostScriptHintValues</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="s">&quot;&lt;Base PS Hint Data&gt;&quot;</span>

<div class="viewcode-block" id="BasePostScriptHintValues.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptHintValues.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this object. Pass an object for parenting if you want.&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asDict</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="n">dont</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;getParent&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dont</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="n">dup</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dup</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
</div></div>
<div class="viewcode-block" id="BasePostScriptGlyphHintValues"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptGlyphHintValues">[docs]</a><span class="k">class</span> <span class="nc">BasePostScriptGlyphHintValues</span><span class="p">(</span><span class="n">BasePostScriptHintValues</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Base class for glyph-level postscript hinting information.</span>
<span class="sd">		vStems, hStems</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">_attributeNames</span> <span class="o">=</span> <span class="p">{</span>
		<span class="c"># some of these values can have only a certain number of elements</span>
		<span class="s">&#39;vHints&#39;</span><span class="p">:</span>		<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;hHints&#39;</span><span class="p">:</span>		<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">},</span>
		<span class="p">}</span>
		
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fromDict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;default&#39;</span><span class="p">])</span>

	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="s">&quot;&lt;PostScript Glyph Hints Values&gt;&quot;</span>

<div class="viewcode-block" id="BasePostScriptGlyphHintValues.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptGlyphHintValues.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Round the values to reasonable values.</span>
<span class="sd">			- stems are rounded to int</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
				<span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]))))</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>

	<span class="c"># math operations for psHint object</span>
	<span class="c"># Note: math operations can change integers to floats.</span></div>
	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BasePostScriptHintValues</span><span class="p">)</span>
		<span class="n">copied</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_processMathOne</span><span class="p">(</span><span class="n">copied</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">copied</span>

	<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BasePostScriptHintValues</span><span class="p">)</span>
		<span class="n">copied</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_processMathOne</span><span class="p">(</span><span class="n">copied</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">sub</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">copied</span>

	<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
		<span class="c">#if isinstance(factor, tuple):</span>
		<span class="c">#	factor = factor[0]</span>
		<span class="n">copiedInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_processMathTwo</span><span class="p">(</span><span class="n">copiedInfo</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">mul</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">copiedInfo</span>

	<span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

	<span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
		<span class="c">#if isinstance(factor, tuple):</span>
		<span class="c">#	factor = factor[0]</span>
		<span class="n">copiedInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_processMathTwo</span><span class="p">(</span><span class="n">copiedInfo</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">div</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">copiedInfo</span>

	<span class="n">__rdiv__</span> <span class="o">=</span> <span class="n">__div__</span>

	<span class="k">def</span> <span class="nf">_processMathOne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copied</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">funct</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">a</span> <span class="o">=</span> <span class="bp">None</span>
			<span class="n">b</span> <span class="o">=</span> <span class="bp">None</span>
			<span class="n">v</span> <span class="o">=</span> <span class="bp">None</span>
			<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">copied</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
				<span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">copied</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
				<span class="n">b</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
					<span class="c"># can&#39;t do math with non matching zones</span>
					<span class="k">continue</span>
				<span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
						<span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="n">ai</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
					<span class="n">bi</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
					<span class="n">l2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ai</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">bi</span><span class="p">))</span>
					<span class="n">v2</span> <span class="o">=</span> <span class="p">[</span><span class="n">funct</span><span class="p">(</span><span class="n">ai</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">bi</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l2</span><span class="p">)]</span>
					<span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="n">copied</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_processMathTwo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copied</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">funct</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">a</span> <span class="o">=</span> <span class="bp">None</span>
			<span class="n">b</span> <span class="o">=</span> <span class="bp">None</span>
			<span class="n">v</span> <span class="o">=</span> <span class="bp">None</span>
			<span class="n">isVertical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;isVertical&#39;</span><span class="p">]</span>
			<span class="n">splitFactor</span> <span class="o">=</span> <span class="n">factor</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
				<span class="c">#print &quot;mathtwo&quot;, name, funct, factor, isVertical</span>
				<span class="k">if</span> <span class="n">isVertical</span><span class="p">:</span>
					<span class="n">splitFactor</span> <span class="o">=</span> <span class="n">factor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">splitFactor</span> <span class="o">=</span> <span class="n">factor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">copied</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
				<span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">copied</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
					<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
						<span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="n">v2</span> <span class="o">=</span> <span class="p">[</span><span class="n">funct</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">splitFactor</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]))]</span>
					<span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="n">copied</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
	
</div>
<div class="viewcode-block" id="BasePostScriptFontHintValues"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptFontHintValues">[docs]</a><span class="k">class</span> <span class="nc">BasePostScriptFontHintValues</span><span class="p">(</span><span class="n">BasePostScriptHintValues</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot; Base class for font-level postscript hinting information.</span>
<span class="sd">		Blues values, stem values.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">_attributeNames</span> <span class="o">=</span> <span class="p">{</span>
		<span class="c"># some of these values can have only a certain number of elements</span>
		<span class="c"># 	default: what the value should be when initialised</span>
		<span class="c">#	max:	the maximum number of items this attribute is allowed to have</span>
		<span class="c">#	isVertical:		the vertical relevance</span>
		<span class="s">&#39;blueFuzz&#39;</span><span class="p">:</span>		<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;blueScale&#39;</span><span class="p">:</span>	<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;blueShift&#39;</span><span class="p">:</span>	<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;forceBold&#39;</span><span class="p">:</span>	<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">},</span>
		<span class="s">&#39;blueValues&#39;</span><span class="p">:</span>	<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;otherBlues&#39;</span><span class="p">:</span>	<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;familyBlues&#39;</span><span class="p">:</span>	<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;familyOtherBlues&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;vStems&#39;</span><span class="p">:</span>		<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">},</span>
		<span class="s">&#39;hStems&#39;</span><span class="p">:</span>		<span class="p">{</span><span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;max&#39;</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span> <span class="s">&#39;isVertical&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">},</span>
		<span class="p">}</span>
		
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fromDict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="s">&quot;&lt;PostScript Font Hints Values&gt;&quot;</span>

	<span class="c"># route attribute calls to info object</span>

	<span class="k">def</span> <span class="nf">_bluesToPairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">values</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
		<span class="n">finalValues</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">finalValues</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">finalValues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
				<span class="n">finalValues</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
			<span class="n">finalValues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">finalValues</span>

	<span class="k">def</span> <span class="nf">_bluesFromPairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">finalValues</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
			<span class="n">finalValues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value1</span><span class="p">)</span>
			<span class="n">finalValues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value2</span><span class="p">)</span>
		<span class="n">finalValues</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">finalValues</span>

	<span class="k">def</span> <span class="nf">_get_blueValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueValues</span>
		<span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bluesToPairs</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">values</span>

	<span class="k">def</span> <span class="nf">_set_blueValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bluesFromPairs</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueValues</span> <span class="o">=</span> <span class="n">values</span>

	<span class="n">blueValues</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_blueValues</span><span class="p">,</span> <span class="n">_set_blueValues</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_otherBlues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptOtherBlues</span>
		<span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bluesToPairs</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">values</span>

	<span class="k">def</span> <span class="nf">_set_otherBlues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bluesFromPairs</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptOtherBlues</span> <span class="o">=</span> <span class="n">values</span>

	<span class="n">otherBlues</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_otherBlues</span><span class="p">,</span> <span class="n">_set_otherBlues</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_familyBlues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFamilyBlues</span>
		<span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bluesToPairs</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">values</span>

	<span class="k">def</span> <span class="nf">_set_familyBlues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bluesFromPairs</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFamilyBlues</span> <span class="o">=</span> <span class="n">values</span>

	<span class="n">familyBlues</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_familyBlues</span><span class="p">,</span> <span class="n">_set_familyBlues</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_familyOtherBlues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFamilyOtherBlues</span>
		<span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bluesToPairs</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">values</span>

	<span class="k">def</span> <span class="nf">_set_familyOtherBlues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bluesFromPairs</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFamilyOtherBlues</span> <span class="o">=</span> <span class="n">values</span>

	<span class="n">familyOtherBlues</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_familyOtherBlues</span><span class="p">,</span> <span class="n">_set_familyOtherBlues</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_vStems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptStemSnapV</span>

	<span class="k">def</span> <span class="nf">_set_vStems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptStemSnapV</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

	<span class="n">vStems</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_vStems</span><span class="p">,</span> <span class="n">_set_vStems</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_hStems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptStemSnapH</span>

	<span class="k">def</span> <span class="nf">_set_hStems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptStemSnapH</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

	<span class="n">hStems</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_hStems</span><span class="p">,</span> <span class="n">_set_hStems</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_blueScale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueScale</span>

	<span class="k">def</span> <span class="nf">_set_blueScale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueScale</span> <span class="o">=</span> <span class="n">value</span>

	<span class="n">blueScale</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_blueScale</span><span class="p">,</span> <span class="n">_set_blueScale</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_blueShift</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueShift</span>

	<span class="k">def</span> <span class="nf">_set_blueShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueShift</span> <span class="o">=</span> <span class="n">value</span>

	<span class="n">blueShift</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_blueShift</span><span class="p">,</span> <span class="n">_set_blueShift</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_blueFuzz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueFuzz</span>

	<span class="k">def</span> <span class="nf">_set_blueFuzz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptBlueFuzz</span> <span class="o">=</span> <span class="n">value</span>

	<span class="n">blueFuzz</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_blueFuzz</span><span class="p">,</span> <span class="n">_set_blueFuzz</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_forceBold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptForceBold</span>

	<span class="k">def</span> <span class="nf">_set_forceBold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptForceBold</span> <span class="o">=</span> <span class="n">value</span>

	<span class="n">forceBold</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_forceBold</span><span class="p">,</span> <span class="n">_set_forceBold</span><span class="p">)</span>

<div class="viewcode-block" id="BasePostScriptFontHintValues.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePostScriptFontHintValues.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Round the values to reasonable values.</span>
<span class="sd">			- blueScale is not rounded, it is a float</span>
<span class="sd">			- forceBold is set to False if -0.5 &lt; value &lt; 0.5. Otherwise it will be True.</span>
<span class="sd">			- blueShift, blueFuzz are rounded to int</span>
<span class="sd">			- stems are rounded to int</span>
<span class="sd">			- blues are rounded to int</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributeNames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;blueScale&quot;</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;forceBold&quot;</span><span class="p">:</span>
				<span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
					<span class="k">continue</span>
				<span class="k">if</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
					<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;blueFuzz&#39;</span><span class="p">,</span> <span class="s">&#39;blueShift&#39;</span><span class="p">]:</span>
				<span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
					<span class="k">continue</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
			<span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;hStems&#39;</span><span class="p">,</span> <span class="s">&#39;vStems&#39;</span><span class="p">]:</span>
				<span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
					<span class="k">continue</span>
				<span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
					<span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
					<span class="k">continue</span>
				<span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
					<span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">n</span><span class="p">])</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>


</div></div>
<span class="k">class</span> <span class="nc">RoboFabInterpolationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span> <span class="k">pass</span>


<span class="k">def</span> <span class="nf">_interpolate</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;interpolate values by factor v&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>

<span class="k">def</span> <span class="nf">_interpolatePt</span><span class="p">((</span><span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">),(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">),</span><span class="n">v</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;interpolate point by factor v&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
		<span class="n">xv</span> <span class="o">=</span> <span class="n">v</span>
		<span class="n">yv</span> <span class="o">=</span> <span class="n">v</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">xv</span><span class="p">,</span> <span class="n">yv</span> <span class="o">=</span> <span class="n">v</span>
	<span class="k">return</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span> <span class="o">*</span> <span class="n">xv</span><span class="p">,</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span> <span class="o">*</span> <span class="n">yv</span>

<span class="k">def</span> <span class="nf">_scalePointFromCenter</span><span class="p">((</span><span class="n">pointX</span><span class="p">,</span> <span class="n">pointY</span><span class="p">),</span> <span class="p">(</span><span class="n">scaleX</span><span class="p">,</span> <span class="n">scaleY</span><span class="p">),</span> <span class="p">(</span><span class="n">centerX</span><span class="p">,</span> <span class="n">centerY</span><span class="p">)):</span>
	<span class="sd">&quot;&quot;&quot;scale a point from a center point&quot;&quot;&quot;</span>
	<span class="n">ogCenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">centerX</span><span class="p">,</span> <span class="n">centerY</span><span class="p">)</span>
	<span class="n">scaledCenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">centerX</span> <span class="o">*</span> <span class="n">scaleX</span><span class="p">,</span> <span class="n">centerY</span> <span class="o">*</span> <span class="n">scaleY</span><span class="p">)</span>
	<span class="n">shiftVal</span> <span class="o">=</span> <span class="p">(</span><span class="n">scaledCenter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ogCenter</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scaledCenter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ogCenter</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">scaledPointX</span> <span class="o">=</span> <span class="p">(</span><span class="n">pointX</span> <span class="o">*</span> <span class="n">scaleX</span><span class="p">)</span> <span class="o">-</span> <span class="n">shiftVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">scaledPointY</span> <span class="o">=</span> <span class="p">(</span><span class="n">pointY</span> <span class="o">*</span> <span class="n">scaleY</span><span class="p">)</span> <span class="o">-</span> <span class="n">shiftVal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">scaledPointX</span><span class="p">,</span> <span class="n">scaledPointY</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_box</span><span class="p">(</span><span class="n">objectToMeasure</span><span class="p">,</span> <span class="n">fontObject</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;calculate the bounds of the object and return it as a (xMin, yMin, xMax, yMax)&quot;&quot;&quot;</span>
	<span class="c">#from fontTools.pens.boundsPen import BoundsPen</span>
	<span class="kn">from</span> <span class="nn">robofab.pens.boundsPen</span> <span class="kn">import</span> <span class="n">BoundsPen</span>
	<span class="n">boundsPen</span> <span class="o">=</span> <span class="n">BoundsPen</span><span class="p">(</span><span class="n">glyphSet</span><span class="o">=</span><span class="n">fontObject</span><span class="p">)</span>
	<span class="n">objectToMeasure</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">boundsPen</span><span class="p">)</span>
	<span class="n">bounds</span> <span class="o">=</span> <span class="n">boundsPen</span><span class="o">.</span><span class="n">bounds</span>
	<span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">bounds</span>

<div class="viewcode-block" id="roundPt"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.roundPt">[docs]</a><span class="k">def</span> <span class="nf">roundPt</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)):</span>
	<span class="sd">&quot;&quot;&quot;Round a vector&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="addPt"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.addPt">[docs]</a><span class="k">def</span> <span class="nf">addPt</span><span class="p">(</span><span class="n">ptA</span><span class="p">,</span> <span class="n">ptB</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Add two vectors&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="n">ptA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ptB</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ptA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ptB</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="subPt"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.subPt">[docs]</a><span class="k">def</span> <span class="nf">subPt</span><span class="p">(</span><span class="n">ptA</span><span class="p">,</span> <span class="n">ptB</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Substract two vectors&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="n">ptA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ptB</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ptA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ptB</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="mulPt"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.mulPt">[docs]</a><span class="k">def</span> <span class="nf">mulPt</span><span class="p">(</span><span class="n">ptA</span><span class="p">,</span> <span class="n">scalar</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Multiply a vector with scalar&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scalar</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
		<span class="n">f1</span> <span class="o">=</span> <span class="n">scalar</span>
		<span class="n">f2</span> <span class="o">=</span> <span class="n">scalar</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">scalar</span>
	<span class="k">return</span> <span class="n">ptA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">f1</span><span class="p">,</span> <span class="n">ptA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">f2</span>
	</div>
<div class="viewcode-block" id="relativeBCPIn"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.relativeBCPIn">[docs]</a><span class="k">def</span> <span class="nf">relativeBCPIn</span><span class="p">(</span><span class="n">anchor</span><span class="p">,</span> <span class="n">BCPIn</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Convert absolute incoming bcp value to a relative value.</span>
<span class="sd">	** NOTE How is this different from relativeBCPOut? **</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">BCPIn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">anchor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">BCPIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">anchor</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="absoluteBCPIn"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.absoluteBCPIn">[docs]</a><span class="k">def</span> <span class="nf">absoluteBCPIn</span><span class="p">(</span><span class="n">anchor</span><span class="p">,</span> <span class="n">BCPIn</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Convert relative incoming bcp value to an absolute value</span>
<span class="sd">	** NOTE How is this different from absoluteBCPOut? **</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">BCPIn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">anchor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">BCPIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">anchor</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="relativeBCPOut"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.relativeBCPOut">[docs]</a><span class="k">def</span> <span class="nf">relativeBCPOut</span><span class="p">(</span><span class="n">anchor</span><span class="p">,</span> <span class="n">BCPOut</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Convert absolute outgoing bcp value to a relative value&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">BCPOut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">anchor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">BCPOut</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">anchor</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="absoluteBCPOut"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.absoluteBCPOut">[docs]</a><span class="k">def</span> <span class="nf">absoluteBCPOut</span><span class="p">(</span><span class="n">anchor</span><span class="p">,</span> <span class="n">BCPOut</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Convert relative outgoing bcp value to an absolute value&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">BCPOut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">anchor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">BCPOut</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">anchor</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="FuzzyNumber"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.FuzzyNumber">[docs]</a><span class="k">class</span> <span class="nc">FuzzyNumber</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Number-like object that will match another fuzzy number if the values are within a specific range.&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
	
	<span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
			<span class="k">return</span> <span class="mi">0</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="nb">cmp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="RBaseObject"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.RBaseObject">[docs]</a><span class="k">class</span> <span class="nc">RBaseObject</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for wrapper objects&quot;&quot;&quot;</span>
	
	<span class="n">attrMap</span><span class="o">=</span> <span class="p">{}</span>
	<span class="n">_title</span> <span class="o">=</span> <span class="s">&quot;RoboFab Wrapper&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_object</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="bp">False</span>
		
	<span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_object</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">name</span> <span class="o">=</span> <span class="sb">`self._object`</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">name</span> <span class="o">=</span> <span class="s">&quot;None&quot;</span>
		<span class="k">return</span> <span class="s">&quot;&lt;</span><span class="si">%s</span><span class="s"> for </span><span class="si">%s</span><span class="s">&gt;&quot;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_title</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
	
<div class="viewcode-block" id="RBaseObject.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.RBaseObject.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this object. Pass an object for parenting if you want.&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="n">dont</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;getParent&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dont</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">RBaseObject</span><span class="p">,</span> <span class="n">BaseLib</span><span class="p">)):</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dup</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
			</div>
<div class="viewcode-block" id="RBaseObject.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.RBaseObject.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Placeholder. Round all numerical values.&quot;&quot;&quot;</span>
		<span class="k">pass</span>
	</div>
<div class="viewcode-block" id="RBaseObject.isRobofab"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.RBaseObject.isRobofab">[docs]</a>	<span class="k">def</span> <span class="nf">isRobofab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Presence of this method indicates a Robofab object&quot;&quot;&quot;</span>
		<span class="k">raise</span>
		<span class="k">return</span> <span class="mi">1</span>
		</div>
<div class="viewcode-block" id="RBaseObject.naked"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.RBaseObject.naked">[docs]</a>	<span class="k">def</span> <span class="nf">naked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Return the wrapped object itself, in case it is needed for direct access.&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object</span>
	</div>
	<span class="k">def</span> <span class="nf">setChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="n">state</span>
	
<div class="viewcode-block" id="RBaseObject.getParent"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.RBaseObject.getParent">[docs]</a>	<span class="k">def</span> <span class="nf">getParent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;this method will be overwritten with a weakref if there is a parent.&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">None</span>
	</div>
	<span class="k">def</span> <span class="nf">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="kn">import</span> <span class="nn">weakref</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
		
	<span class="k">def</span> <span class="nf">_writeXML</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
		<span class="k">pass</span>

</div>
<div class="viewcode-block" id="BaseFont"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont">[docs]</a><span class="k">class</span> <span class="nc">BaseFont</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all font objects.&quot;&quot;&quot;</span>
	
	<span class="n">_allFonts</span> <span class="o">=</span> <span class="p">[]</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="kn">import</span> <span class="nn">weakref</span>
		<span class="n">RBaseObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allFonts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_supportHints</span> <span class="o">=</span> <span class="bp">False</span>
		
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
		<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
			<span class="n">name</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RFont font for </span><span class="si">%s</span><span class="s">&gt;&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="c">#Compare this font with another, compare if they refer to the same file.</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
		
	<span class="k">def</span> <span class="nf">_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Compare this font to other. RF and FL UFO implementations need</span>
<span class="sd">		slightly different ways of comparing fonts. This method does the</span>
<span class="sd">		basic stuff. Start with simple and quick comparisons, then move into</span>
<span class="sd">		detailed comparisons of glyphs.&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s">&quot;fileName&quot;</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">False</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">fileName</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">True</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span> <span class="o">&lt;&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">fileName</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">False</span>
		<span class="c"># this will falsely identify two distinct &quot;Untitled&quot; as equal</span>
		<span class="c"># so test some more. A lot of work to please some dolt who</span>
		<span class="c"># does not save his fonts while running scripts.</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
				<span class="k">return</span> <span class="bp">False</span>
		<span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">False</span>
		<span class="c"># same name and length. start comparing glyphs</span>
		<span class="n">namesSelf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		<span class="n">namesOther</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		<span class="n">namesSelf</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
		<span class="n">namesOther</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">namesSelf</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">namesSelf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&gt;</span> <span class="n">namesOther</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
				<span class="k">return</span> <span class="bp">False</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">c</span> <span class="o">==</span> <span class="n">other</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
				<span class="k">return</span> <span class="bp">False</span>
		<span class="k">return</span> <span class="bp">True</span>
		
	<span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c"># must be implemented by subclass</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span>

	<span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">glyphName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGlyph</span><span class="p">(</span><span class="n">glyphName</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphName</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGlyph</span><span class="p">(</span><span class="n">glyphName</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphName</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyphName</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c">#mark the object as changed</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
	
<div class="viewcode-block" id="BaseFont.update"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;update the font&quot;&quot;&quot;</span>
		<span class="k">pass</span>
	</div>
<div class="viewcode-block" id="BaseFont.close"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.close">[docs]</a>	<span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Close the font, saving is optional.&quot;&quot;&quot;</span>
		<span class="k">pass</span>
</div>
<div class="viewcode-block" id="BaseFont.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;round all of the points in all of the glyphs&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">glyphs</span><span class="p">:</span>
			<span class="n">glyph</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
	</div>
<div class="viewcode-block" id="BaseFont.autoUnicodes"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.autoUnicodes">[docs]</a>	<span class="k">def</span> <span class="nf">autoUnicodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Using fontTools.agl, assign Unicode lists to all glyphs in the font&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
			<span class="n">glyph</span><span class="o">.</span><span class="n">autoUnicodes</span><span class="p">()</span>
			</div>
<div class="viewcode-block" id="BaseFont.getCharacterMapping"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.getCharacterMapping">[docs]</a>	<span class="k">def</span> <span class="nf">getCharacterMapping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Create a dictionary of unicode -&gt; [glyphname, ...] mappings.</span>
<span class="sd">		Note that this dict is created each time this method is called, </span>
<span class="sd">		which can make it expensive for larger fonts. All glyphs are loaded.</span>
<span class="sd">		Note that one glyph can have multiple unicode values,</span>
<span class="sd">		and a unicode value can have multiple glyphs pointing to it.&quot;&quot;&quot;</span>
		<span class="nb">map</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">glyph</span><span class="o">.</span><span class="n">unicodes</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="nb">map</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
					<span class="nb">map</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="nb">map</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">map</span>
	</div>
<div class="viewcode-block" id="BaseFont.getReverseComponentMapping"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.getReverseComponentMapping">[docs]</a>	<span class="k">def</span> <span class="nf">getReverseComponentMapping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Get a reversed map of component references in the font.</span>
<span class="sd">		{</span>
<span class="sd">		&#39;A&#39; : [&#39;Aacute&#39;, &#39;Aring&#39;]</span>
<span class="sd">		&#39;acute&#39; : [&#39;Aacute&#39;]</span>
<span class="sd">		&#39;ring&#39; : [&#39;Aring&#39;]</span>
<span class="sd">		etc.</span>
<span class="sd">		}</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="nb">map</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
			<span class="n">glyphName</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">name</span>
			<span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">glyph</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
				<span class="n">baseGlyphName</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">baseGlyph</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="nb">map</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">baseGlyphName</span><span class="p">):</span>
					<span class="nb">map</span><span class="p">[</span><span class="n">baseGlyphName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="nb">map</span><span class="p">[</span><span class="n">baseGlyphName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">glyphName</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">map</span>
</div>
<div class="viewcode-block" id="BaseFont.compileGlyph"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.compileGlyph">[docs]</a>	<span class="k">def</span> <span class="nf">compileGlyph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphName</span><span class="p">,</span> <span class="n">baseName</span><span class="p">,</span> <span class="n">accentNames</span><span class="p">,</span> \
		<span class="n">adjustWidth</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">preflight</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">printErrors</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Compile components into a new glyph using components and anchorpoints.</span>
<span class="sd">		glyphName: the name of the glyph where it all needs to go</span>
<span class="sd">		baseName: the name of the base glyph</span>
<span class="sd">		accentNames: a list of accentName, anchorName tuples, [(&#39;acute&#39;, &#39;top&#39;), etc]</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">anchors</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">errors</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">baseGlyph</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">anchor</span> <span class="ow">in</span> <span class="n">baseGlyph</span><span class="o">.</span><span class="n">getAnchors</span><span class="p">():</span>
			<span class="n">anchors</span><span class="p">[</span><span class="n">anchor</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">anchor</span><span class="o">.</span><span class="n">position</span>
		<span class="n">destGlyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newGlyph</span><span class="p">(</span><span class="n">glyphName</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
		<span class="n">destGlyph</span><span class="o">.</span><span class="n">appendComponent</span><span class="p">(</span><span class="n">baseName</span><span class="p">)</span>
		<span class="n">destGlyph</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">baseGlyph</span><span class="o">.</span><span class="n">width</span>
		<span class="k">for</span> <span class="n">accentName</span><span class="p">,</span> <span class="n">anchorName</span> <span class="ow">in</span> <span class="n">accentNames</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">accent</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">accentName</span><span class="p">]</span>
			<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
				<span class="n">errors</span><span class="p">[</span><span class="s">&quot;glyph &#39;</span><span class="si">%s</span><span class="s">&#39; is missing in font </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">accentName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">fullName</span><span class="p">)]</span> <span class="o">=</span>  <span class="mi">1</span>
				<span class="k">continue</span>
			<span class="n">shift</span> <span class="o">=</span> <span class="bp">None</span>
			<span class="k">for</span> <span class="n">accentAnchor</span> <span class="ow">in</span> <span class="n">accent</span><span class="o">.</span><span class="n">getAnchors</span><span class="p">():</span>
				<span class="k">if</span> <span class="s">&#39;_&#39;</span><span class="o">+</span><span class="n">anchorName</span> <span class="o">==</span> <span class="n">accentAnchor</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
					<span class="n">shift</span> <span class="o">=</span> <span class="n">anchors</span><span class="p">[</span><span class="n">anchorName</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">accentAnchor</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">anchors</span><span class="p">[</span><span class="n">anchorName</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">accentAnchor</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
					<span class="n">destGlyph</span><span class="o">.</span><span class="n">appendComponent</span><span class="p">(</span><span class="n">accentName</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">shift</span><span class="p">)</span>
					<span class="k">break</span>
			<span class="k">if</span> <span class="n">shift</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">accentAnchor</span> <span class="ow">in</span> <span class="n">accent</span><span class="o">.</span><span class="n">getAnchors</span><span class="p">():</span>
					<span class="k">if</span> <span class="n">accentAnchor</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">anchors</span><span class="p">:</span>
						<span class="n">anchors</span><span class="p">[</span><span class="n">accentAnchor</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">shift</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">accentAnchor</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shift</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">accentAnchor</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">printErrors</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">px</span> <span class="ow">in</span> <span class="n">errors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="k">print</span> <span class="n">px</span>
		<span class="k">return</span> <span class="n">destGlyph</span>
	</div>
<div class="viewcode-block" id="BaseFont.generateGlyph"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.generateGlyph">[docs]</a>	<span class="k">def</span> <span class="nf">generateGlyph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphName</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">preflight</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">printErrors</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Generate a glyph and return it. Assembled from GlyphConstruction.txt&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">robofab.tools.toolsAll</span> <span class="kn">import</span> <span class="n">readGlyphConstructions</span>
		<span class="n">con</span> <span class="o">=</span> <span class="n">readGlyphConstructions</span><span class="p">()</span>
		<span class="n">entry</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">glyphName</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="p">:</span>
			<span class="k">print</span> <span class="s">&quot;glyph &#39;</span><span class="si">%s</span><span class="s">&#39; is not listed in the robofab/Data/GlyphConstruction.txt&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">glyphName</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="n">baseName</span> <span class="o">=</span> <span class="n">con</span><span class="p">[</span><span class="n">glyphName</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">parts</span> <span class="o">=</span> <span class="n">con</span><span class="p">[</span><span class="n">glyphName</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compileGlyph</span><span class="p">(</span><span class="n">glyphName</span><span class="p">,</span> <span class="n">baseName</span><span class="p">,</span> <span class="n">parts</span><span class="p">,</span> <span class="n">adjustWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">preflight</span><span class="o">=</span><span class="n">preflight</span><span class="p">,</span> <span class="n">printErrors</span><span class="o">=</span><span class="n">printErrors</span><span class="p">)</span>
	</div>
<div class="viewcode-block" id="BaseFont.interpolate"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseFont.interpolate">[docs]</a>	<span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">minFont</span><span class="p">,</span> <span class="n">maxFont</span><span class="p">,</span> <span class="n">suppressError</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">analyzeOnly</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">doProgress</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Traditional interpolation method. Interpolates by factor between minFont and maxFont.</span>
<span class="sd">		suppressError will supress all tracebacks and analyze only will not perform the interpolation</span>
<span class="sd">		but it will analyze all glyphs and return a dict of problems.&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">sets</span> <span class="kn">import</span> <span class="n">Set</span>
		<span class="n">errors</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span><span class="p">,</span> <span class="n">factor</span>
		<span class="n">minGlyphNames</span> <span class="o">=</span> <span class="n">minFont</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		<span class="n">maxGlyphNames</span> <span class="o">=</span> <span class="n">maxFont</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		<span class="n">allGlyphNames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Set</span><span class="p">(</span><span class="n">minGlyphNames</span><span class="p">)</span> <span class="o">|</span> <span class="n">Set</span><span class="p">(</span><span class="n">maxGlyphNames</span><span class="p">))</span>
		<span class="k">if</span> <span class="n">doProgress</span><span class="p">:</span>
			<span class="kn">from</span> <span class="nn">robofab.interface.all.dialogs</span> <span class="kn">import</span> <span class="n">ProgressBar</span>
			<span class="n">progress</span> <span class="o">=</span> <span class="n">ProgressBar</span><span class="p">(</span><span class="s">&#39;Interpolating...&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">allGlyphNames</span><span class="p">))</span>
			<span class="n">tickCount</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="c"># some dimensions and values</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ascender</span> <span class="o">=</span> <span class="n">_interpolate</span><span class="p">(</span><span class="n">minFont</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ascender</span><span class="p">,</span> <span class="n">maxFont</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ascender</span><span class="p">,</span> <span class="n">factor</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">descender</span> <span class="o">=</span> <span class="n">_interpolate</span><span class="p">(</span><span class="n">minFont</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">descender</span><span class="p">,</span> <span class="n">maxFont</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">descender</span><span class="p">,</span> <span class="n">factor</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="c"># check for the presence of the glyph in each of the fonts</span>
		<span class="k">for</span> <span class="n">glyphName</span> <span class="ow">in</span> <span class="n">allGlyphNames</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">doProgress</span><span class="p">:</span>
				<span class="n">progress</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">glyphName</span><span class="p">)</span>
			<span class="n">fatalError</span> <span class="o">=</span> <span class="bp">False</span>
			<span class="k">if</span> <span class="n">glyphName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">minGlyphNames</span><span class="p">:</span>
				<span class="n">fatalError</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;Missing Glyphs&#39;</span><span class="p">):</span>
					<span class="n">errors</span><span class="p">[</span><span class="s">&#39;Missing Glyphs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="n">errors</span><span class="p">[</span><span class="s">&#39;Missing Glyphs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;Interpolation Error: </span><span class="si">%s</span><span class="s"> not in </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">glyphName</span><span class="p">,</span> <span class="n">minFont</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">glyphName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">maxGlyphNames</span><span class="p">:</span>
				<span class="n">fatalError</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;Missing Glyphs&#39;</span><span class="p">):</span>
					<span class="n">errors</span><span class="p">[</span><span class="s">&#39;Missing Glyphs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="n">errors</span><span class="p">[</span><span class="s">&#39;Missing Glyphs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;Interpolation Error: </span><span class="si">%s</span><span class="s"> not in </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">glyphName</span><span class="p">,</span> <span class="n">maxFont</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span><span class="p">))</span>
			<span class="c"># if no major problems, proceed.</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">fatalError</span><span class="p">:</span>
				<span class="c"># remove the glyph since FontLab has a problem with</span>
				<span class="c"># interpolating an existing glyph that contains</span>
				<span class="c"># some contour data.</span>
				<span class="n">oldLib</span> <span class="o">=</span> <span class="p">{}</span>
				<span class="n">oldMark</span> <span class="o">=</span> <span class="bp">None</span>
				<span class="n">oldNote</span> <span class="o">=</span> <span class="bp">None</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">glyphName</span><span class="p">):</span>
					<span class="n">glyph</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">glyphName</span><span class="p">]</span>
					<span class="n">oldLib</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
					<span class="n">oldMark</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">mark</span>
					<span class="n">oldNote</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">note</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">removeGlyph</span><span class="p">(</span><span class="n">glyphName</span><span class="p">)</span>
				<span class="n">selfGlyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newGlyph</span><span class="p">(</span><span class="n">glyphName</span><span class="p">)</span>
				<span class="n">selfGlyph</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">oldLib</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">oldMark</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
					<span class="n">selfGlyph</span><span class="o">.</span><span class="n">mark</span> <span class="o">=</span> <span class="n">oldMark</span>
				<span class="n">selfGlyph</span><span class="o">.</span><span class="n">note</span> <span class="o">=</span> <span class="n">oldNote</span>
				<span class="nb">min</span> <span class="o">=</span> <span class="n">minFont</span><span class="p">[</span><span class="n">glyphName</span><span class="p">]</span>
				<span class="nb">max</span> <span class="o">=</span> <span class="n">maxFont</span><span class="p">[</span><span class="n">glyphName</span><span class="p">]</span>
				<span class="n">ok</span><span class="p">,</span> <span class="n">glyphErrors</span> <span class="o">=</span> <span class="n">selfGlyph</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">suppressError</span><span class="o">=</span><span class="n">suppressError</span><span class="p">,</span> <span class="n">analyzeOnly</span><span class="o">=</span><span class="n">analyzeOnly</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;Glyph Errors&#39;</span><span class="p">):</span>
					<span class="n">errors</span><span class="p">[</span><span class="s">&#39;Glyph Errors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
				<span class="n">errors</span><span class="p">[</span><span class="s">&#39;Glyph Errors&#39;</span><span class="p">][</span><span class="n">glyphName</span><span class="p">]</span> <span class="o">=</span> <span class="n">glyphErrors</span>
			<span class="k">if</span> <span class="n">doProgress</span><span class="p">:</span>
				<span class="n">progress</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">tickCount</span><span class="p">)</span>
				<span class="n">tickCount</span> <span class="o">=</span> <span class="n">tickCount</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="n">doProgress</span><span class="p">:</span>
			<span class="n">progress</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">errors</span>
</div>
	<span class="k">def</span> <span class="nf">getGlyphNameToFileNameFunc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">funcName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;org.robofab.glyphNameToFileNameFuncName&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">funcName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span>
		<span class="n">parts</span> <span class="o">=</span> <span class="n">funcName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)</span>
		<span class="n">module</span> <span class="o">=</span> <span class="s">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">item</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
				<span class="n">item</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">sub</span><span class="p">)</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">ImportError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
			<span class="n">warn</span><span class="p">(</span><span class="s">&quot;Can&#39;t find glyph name to file name converter function, &quot;</span>
				<span class="s">&quot;falling back to default scheme (</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">funcName</span><span class="p">,</span> <span class="n">RoboFabWarning</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">None</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">item</span>

</div>
<div class="viewcode-block" id="BaseGlyph"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph">[docs]</a><span class="k">class</span> <span class="nc">BaseGlyph</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all glyph objects.&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">RBaseObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="c">#self.contours = []</span>
		<span class="c">#self.components = []</span>
		<span class="c">#self.anchors = []</span>
		<span class="c">#self.width = 0</span>
		<span class="c">#self.note = None</span>
		<span class="c">##self.unicodes = []</span>
		<span class="c">#self.selected = None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
	
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="s">&quot;unnamed_glyph&quot;</span>
		<span class="n">fontParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
				<span class="k">pass</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">glyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
		<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
			<span class="k">pass</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RGlyph for </span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">&gt;&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">glyph</span><span class="p">)</span>
		
	<span class="c">#</span>
	<span class="c"># Glyph Math</span>
	<span class="c">#</span>
	
	<span class="k">def</span> <span class="nf">_getMathData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="kn">from</span> <span class="nn">robofab.pens.mathPens</span> <span class="kn">import</span> <span class="n">GetMathDataPointPen</span>
		<span class="n">pen</span> <span class="o">=</span> <span class="n">GetMathDataPointPen</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">pen</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">data</span>
	
	<span class="k">def</span> <span class="nf">_setMathData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="kn">from</span> <span class="nn">robofab.pens.mathPens</span> <span class="kn">import</span> <span class="n">CurveSegmentFilterPointPen</span>
		<span class="k">if</span> <span class="n">destination</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">newGlyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mathCopy</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">newGlyph</span> <span class="o">=</span> <span class="n">destination</span>
		<span class="n">newGlyph</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="c">#</span>
		<span class="c"># draw the data onto the glyph</span>
		<span class="n">pointPen</span> <span class="o">=</span> <span class="n">newGlyph</span><span class="o">.</span><span class="n">getPointPen</span><span class="p">()</span>
		<span class="n">filterPen</span> <span class="o">=</span> <span class="n">CurveSegmentFilterPointPen</span><span class="p">(</span><span class="n">pointPen</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">]:</span>
			<span class="n">filterPen</span><span class="o">.</span><span class="n">beginPath</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">segmentType</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">smooth</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">contour</span><span class="p">:</span>
				<span class="n">filterPen</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="n">pt</span><span class="p">,</span> <span class="n">segmentType</span><span class="o">=</span><span class="n">segmentType</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
			<span class="n">filterPen</span><span class="o">.</span><span class="n">endPath</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">baseName</span><span class="p">,</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">]:</span>
			<span class="n">filterPen</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">baseName</span><span class="p">,</span> <span class="n">transformation</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">]:</span>
			<span class="n">filterPen</span><span class="o">.</span><span class="n">beginPath</span><span class="p">()</span>
			<span class="n">filterPen</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="n">pt</span><span class="p">,</span> <span class="n">segmentType</span><span class="o">=</span><span class="s">&quot;move&quot;</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
			<span class="n">filterPen</span><span class="o">.</span><span class="n">endPath</span><span class="p">()</span>
		<span class="n">newGlyph</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;width&#39;</span><span class="p">]</span>
		<span class="n">psHints</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;psHints&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">psHints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">newGlyph</span><span class="o">.</span><span class="n">psHints</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">psHints</span><span class="p">)</span>
		<span class="c">#</span>
		<span class="k">return</span> <span class="n">newGlyph</span>
	
	<span class="k">def</span> <span class="nf">_getMathDestination</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c"># make a new, empty glyph</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
	
	<span class="k">def</span> <span class="nf">_mathCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c"># copy self without contour, component and anchor data</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMathDestination</span><span class="p">()</span>
		<span class="n">glyph</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
		<span class="n">glyph</span><span class="o">.</span><span class="n">unicodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicodes</span><span class="p">)</span>
		<span class="n">glyph</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
		<span class="n">glyph</span><span class="o">.</span><span class="n">note</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">note</span>
		<span class="n">glyph</span><span class="o">.</span><span class="n">lib</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lib</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">glyph</span>
	
	<span class="k">def</span> <span class="nf">_processMathOne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otherGlyph</span><span class="p">,</span> <span class="n">funct</span><span class="p">):</span>
		<span class="c"># used by: __add__, __sub__</span>
		<span class="c">#</span>
		<span class="n">newData</span> <span class="o">=</span>	<span class="p">{</span>
				<span class="s">&#39;contours&#39;</span><span class="p">:[],</span>
				<span class="s">&#39;components&#39;</span><span class="p">:[],</span>
				<span class="s">&#39;anchors&#39;</span><span class="p">:[],</span>
				<span class="s">&#39;width&#39;</span><span class="p">:</span><span class="bp">None</span>
				<span class="p">}</span>
		<span class="n">selfData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMathData</span><span class="p">()</span>
		<span class="n">otherData</span> <span class="o">=</span> <span class="n">otherGlyph</span><span class="o">.</span><span class="n">_getMathData</span><span class="p">()</span>
		<span class="c">#</span>
		<span class="c"># contours</span>
		<span class="n">selfContours</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">]</span>
		<span class="n">otherContours</span> <span class="o">=</span> <span class="n">otherData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">]</span>
		<span class="n">newContours</span> <span class="o">=</span> <span class="n">newData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfContours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">contourIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selfContours</span><span class="p">)):</span>
				<span class="n">newContours</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
				<span class="n">selfContour</span> <span class="o">=</span> <span class="n">selfContours</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span>
				<span class="n">otherContour</span> <span class="o">=</span> <span class="n">otherContours</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">pointIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selfContour</span><span class="p">)):</span>
					<span class="n">segType</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">smooth</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">selfContour</span><span class="p">[</span><span class="n">pointIndex</span><span class="p">]</span>
					<span class="n">newX</span><span class="p">,</span> <span class="n">newY</span> <span class="o">=</span> <span class="n">funct</span><span class="p">(</span><span class="n">selfContour</span><span class="p">[</span><span class="n">pointIndex</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">otherContour</span><span class="p">[</span><span class="n">pointIndex</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
					<span class="n">newContours</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">segType</span><span class="p">,</span> <span class="p">(</span><span class="n">newX</span><span class="p">,</span> <span class="n">newY</span><span class="p">),</span> <span class="n">smooth</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
		<span class="c"># anchors</span>
		<span class="n">selfAnchors</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">]</span>
		<span class="n">otherAnchors</span> <span class="o">=</span> <span class="n">otherData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">]</span>
		<span class="n">newAnchors</span> <span class="o">=</span> <span class="n">newData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfAnchors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">selfAnchors</span><span class="p">,</span> <span class="n">otherAnchors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mathAnchorCompare</span><span class="p">(</span><span class="n">selfAnchors</span><span class="p">,</span> <span class="n">otherAnchors</span><span class="p">)</span>
			<span class="n">anchorNames</span> <span class="o">=</span> <span class="n">selfAnchors</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">anchorName</span> <span class="ow">in</span> <span class="n">anchorNames</span><span class="p">:</span>
				<span class="n">selfAnchorList</span> <span class="o">=</span> <span class="n">selfAnchors</span><span class="p">[</span><span class="n">anchorName</span><span class="p">]</span>
				<span class="n">otherAnchorList</span> <span class="o">=</span> <span class="n">otherAnchors</span><span class="p">[</span><span class="n">anchorName</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selfAnchorList</span><span class="p">)):</span>
					<span class="n">selfAnchor</span> <span class="o">=</span> <span class="n">selfAnchorList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
					<span class="n">otherAnchor</span> <span class="o">=</span> <span class="n">otherAnchorList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
					<span class="n">newAnchor</span> <span class="o">=</span> <span class="n">funct</span><span class="p">(</span><span class="n">selfAnchor</span><span class="p">,</span> <span class="n">otherAnchor</span><span class="p">)</span>
					<span class="n">newAnchors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">newAnchor</span><span class="p">,</span> <span class="n">anchorName</span><span class="p">))</span>
		<span class="c"># components</span>
		<span class="n">selfComponents</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">]</span>
		<span class="n">otherComponents</span> <span class="o">=</span> <span class="n">otherData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">]</span>
		<span class="n">newComponents</span> <span class="o">=</span> <span class="n">newData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfComponents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">selfComponents</span><span class="p">,</span> <span class="n">otherComponents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mathComponentCompare</span><span class="p">(</span><span class="n">selfComponents</span><span class="p">,</span> <span class="n">otherComponents</span><span class="p">)</span>
			<span class="n">componentNames</span> <span class="o">=</span> <span class="n">selfComponents</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">componentName</span> <span class="ow">in</span> <span class="n">componentNames</span><span class="p">:</span>
				<span class="n">selfComponentList</span> <span class="o">=</span> <span class="n">selfComponents</span><span class="p">[</span><span class="n">componentName</span><span class="p">]</span>
				<span class="n">otherComponentList</span> <span class="o">=</span> <span class="n">otherComponents</span><span class="p">[</span><span class="n">componentName</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selfComponentList</span><span class="p">)):</span>
					<span class="c"># transformation breakdown: xScale, xyScale, yxScale, yScale, xOffset, yOffset</span>
					<span class="n">selfXScale</span><span class="p">,</span> <span class="n">selfXYScale</span><span class="p">,</span> <span class="n">selfYXScale</span><span class="p">,</span> <span class="n">selfYScale</span><span class="p">,</span> <span class="n">selfXOffset</span><span class="p">,</span> <span class="n">selfYOffset</span> <span class="o">=</span> <span class="n">selfComponentList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
					<span class="n">otherXScale</span><span class="p">,</span> <span class="n">otherXYScale</span><span class="p">,</span> <span class="n">otherYXScale</span><span class="p">,</span> <span class="n">otherYScale</span><span class="p">,</span> <span class="n">otherXOffset</span><span class="p">,</span> <span class="n">otherYOffset</span> <span class="o">=</span> <span class="n">otherComponentList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
					<span class="n">newXScale</span><span class="p">,</span> <span class="n">newXYScale</span> <span class="o">=</span> <span class="n">funct</span><span class="p">((</span><span class="n">selfXScale</span><span class="p">,</span> <span class="n">selfXYScale</span><span class="p">),</span> <span class="p">(</span><span class="n">otherXScale</span><span class="p">,</span> <span class="n">otherXYScale</span><span class="p">))</span>
					<span class="n">newYXScale</span><span class="p">,</span> <span class="n">newYScale</span> <span class="o">=</span> <span class="n">funct</span><span class="p">((</span><span class="n">selfYXScale</span><span class="p">,</span> <span class="n">selfYScale</span><span class="p">),</span> <span class="p">(</span><span class="n">otherYXScale</span><span class="p">,</span> <span class="n">otherYScale</span><span class="p">))</span>
					<span class="n">newXOffset</span><span class="p">,</span> <span class="n">newYOffset</span> <span class="o">=</span> <span class="n">funct</span><span class="p">((</span><span class="n">selfXOffset</span><span class="p">,</span> <span class="n">selfYOffset</span><span class="p">),</span> <span class="p">(</span><span class="n">otherXOffset</span><span class="p">,</span> <span class="n">otherYOffset</span><span class="p">))</span>
					<span class="n">newComponents</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">componentName</span><span class="p">,</span> <span class="p">(</span><span class="n">newXScale</span><span class="p">,</span> <span class="n">newXYScale</span><span class="p">,</span> <span class="n">newYXScale</span><span class="p">,</span> <span class="n">newYScale</span><span class="p">,</span> <span class="n">newXOffset</span><span class="p">,</span> <span class="n">newYOffset</span><span class="p">)))</span>
		<span class="k">return</span> <span class="n">newData</span>
	
	<span class="k">def</span> <span class="nf">_processMathTwo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">funct</span><span class="p">):</span>
		<span class="c"># used by: __mul__, __div__</span>
		<span class="c">#</span>
		<span class="n">newData</span> <span class="o">=</span>	<span class="p">{</span>
				<span class="s">&#39;contours&#39;</span><span class="p">:[],</span>
				<span class="s">&#39;components&#39;</span><span class="p">:[],</span>
				<span class="s">&#39;anchors&#39;</span><span class="p">:[],</span>
				<span class="s">&#39;width&#39;</span><span class="p">:</span><span class="bp">None</span>
				<span class="p">}</span>
		<span class="n">selfData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMathData</span><span class="p">()</span>
		<span class="c"># contours</span>
		<span class="n">selfContours</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">]</span>
		<span class="n">newContours</span> <span class="o">=</span> <span class="n">newData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">selfContour</span> <span class="ow">in</span> <span class="n">selfContours</span><span class="p">:</span>
			<span class="n">newContours</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
			<span class="k">for</span> <span class="n">segType</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">smooth</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">selfContour</span><span class="p">:</span>
				<span class="n">newX</span><span class="p">,</span> <span class="n">newY</span> <span class="o">=</span> <span class="n">funct</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
				<span class="n">newContours</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">segType</span><span class="p">,</span> <span class="p">(</span><span class="n">newX</span><span class="p">,</span> <span class="n">newY</span><span class="p">),</span> <span class="n">smooth</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
		<span class="c"># anchors</span>
		<span class="n">selfAnchors</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">]</span>
		<span class="n">newAnchors</span> <span class="o">=</span> <span class="n">newData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">anchorName</span> <span class="ow">in</span> <span class="n">selfAnchors</span><span class="p">:</span>
			<span class="n">newPt</span> <span class="o">=</span> <span class="n">funct</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
			<span class="n">newAnchors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">newPt</span><span class="p">,</span> <span class="n">anchorName</span><span class="p">))</span>
		<span class="c"># components</span>
		<span class="n">selfComponents</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">]</span>
		<span class="n">newComponents</span> <span class="o">=</span> <span class="n">newData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">baseName</span><span class="p">,</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="n">selfComponents</span><span class="p">:</span>
			<span class="n">xScale</span><span class="p">,</span> <span class="n">xyScale</span><span class="p">,</span> <span class="n">yxScale</span><span class="p">,</span> <span class="n">yScale</span><span class="p">,</span> <span class="n">xOffset</span><span class="p">,</span> <span class="n">yOffset</span> <span class="o">=</span> <span class="n">transformation</span>
			<span class="n">newXOffset</span><span class="p">,</span> <span class="n">newYOffset</span> <span class="o">=</span> <span class="n">funct</span><span class="p">((</span><span class="n">xOffset</span><span class="p">,</span> <span class="n">yOffset</span><span class="p">),</span> <span class="n">factor</span><span class="p">)</span>
			<span class="n">newXScale</span><span class="p">,</span> <span class="n">newYScale</span> <span class="o">=</span> <span class="n">funct</span><span class="p">((</span><span class="n">xScale</span><span class="p">,</span> <span class="n">yScale</span><span class="p">),</span> <span class="n">factor</span><span class="p">)</span>
			<span class="n">newXYScale</span><span class="p">,</span> <span class="n">newYXScale</span> <span class="o">=</span> <span class="n">funct</span><span class="p">((</span><span class="n">xyScale</span><span class="p">,</span> <span class="n">yxScale</span><span class="p">),</span> <span class="n">factor</span><span class="p">)</span>
			<span class="n">newComponents</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">baseName</span><span class="p">,</span> <span class="p">(</span><span class="n">newXScale</span><span class="p">,</span> <span class="n">newXYScale</span><span class="p">,</span> <span class="n">newYXScale</span><span class="p">,</span> <span class="n">newYScale</span><span class="p">,</span> <span class="n">newXOffset</span><span class="p">,</span> <span class="n">newYOffset</span><span class="p">)))</span>
		<span class="c"># return the data</span>
		<span class="k">return</span> <span class="n">newData</span>
	
	<span class="k">def</span> <span class="nf">_mathAnchorCompare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selfMathAnchors</span><span class="p">,</span> <span class="n">otherMathAnchors</span><span class="p">):</span>
		<span class="c"># collect compatible anchors</span>
		<span class="kn">from</span> <span class="nn">sets</span> <span class="kn">import</span> <span class="n">Set</span>
		<span class="n">selfAnchors</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">selfMathAnchors</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">selfAnchors</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
				<span class="n">selfAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">selfAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
		<span class="n">otherAnchors</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">otherMathAnchors</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">otherAnchors</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
				<span class="n">otherAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">otherAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
		<span class="n">compatAnchors</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">selfAnchors</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="n">Set</span><span class="p">(</span><span class="n">otherAnchors</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="n">finalSelfAnchors</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">finalOtherAnchors</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">compatAnchors</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">finalSelfAnchors</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
				<span class="n">finalSelfAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">finalOtherAnchors</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
				<span class="n">finalOtherAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">selfList</span> <span class="o">=</span> <span class="n">selfAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
			<span class="n">otherList</span> <span class="o">=</span> <span class="n">otherAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
			<span class="n">selfCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfList</span><span class="p">)</span>
			<span class="n">otherCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherList</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">selfCount</span> <span class="o">!=</span> <span class="n">otherCount</span><span class="p">:</span>
				<span class="n">r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">selfCount</span><span class="p">,</span> <span class="n">otherCount</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">selfCount</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
				<span class="n">finalSelfAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selfList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="n">finalOtherAnchors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">otherList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">finalSelfAnchors</span><span class="p">,</span> <span class="n">finalOtherAnchors</span>
	
	<span class="k">def</span> <span class="nf">_mathComponentCompare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selfMathComponents</span><span class="p">,</span> <span class="n">otherMathComponents</span><span class="p">):</span>
		<span class="c"># collect compatible components</span>
		<span class="kn">from</span> <span class="nn">sets</span> <span class="kn">import</span> <span class="n">Set</span>
		<span class="n">selfComponents</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">baseName</span><span class="p">,</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="n">selfMathComponents</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">selfComponents</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">baseName</span><span class="p">):</span>
				<span class="n">selfComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">selfComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformation</span><span class="p">)</span>
		<span class="n">otherComponents</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">baseName</span><span class="p">,</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="n">otherMathComponents</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">otherComponents</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">baseName</span><span class="p">):</span>
				<span class="n">otherComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">otherComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformation</span><span class="p">)</span>
		<span class="n">compatComponents</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">selfComponents</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="n">Set</span><span class="p">(</span><span class="n">otherComponents</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="n">finalSelfComponents</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">finalOtherComponents</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">baseName</span> <span class="ow">in</span> <span class="n">compatComponents</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">finalSelfComponents</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">baseName</span><span class="p">):</span>
				<span class="n">finalSelfComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">finalOtherComponents</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">baseName</span><span class="p">):</span>
				<span class="n">finalOtherComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">selfList</span> <span class="o">=</span> <span class="n">selfComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span>
			<span class="n">otherList</span> <span class="o">=</span> <span class="n">otherComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span>
			<span class="n">selfCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfList</span><span class="p">)</span>
			<span class="n">otherCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherList</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">selfCount</span> <span class="o">!=</span> <span class="n">otherCount</span><span class="p">:</span>
				<span class="n">r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">selfCount</span><span class="p">,</span> <span class="n">otherCount</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">selfCount</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
				<span class="n">finalSelfComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selfList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="n">finalOtherComponents</span><span class="p">[</span><span class="n">baseName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">otherList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">finalSelfComponents</span><span class="p">,</span> <span class="n">finalOtherComponents</span>
		
	<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)),</span> <span class="s">&quot;Glyphs can only be multiplied by int, float or a 2-tuple.&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="n">factor</span> <span class="o">=</span> <span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
		<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processMathTwo</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">mulPt</span><span class="p">)</span>
		<span class="n">data</span><span class="p">[</span><span class="s">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">factor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="c"># psHints</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">psHints</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
			<span class="n">newPsHints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">psHints</span> <span class="o">*</span> <span class="n">factor</span>
			<span class="n">data</span><span class="p">[</span><span class="s">&#39;psHints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newPsHints</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setMathData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

	<span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

	<span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)),</span> <span class="s">&quot;Glyphs can only be divided by int, float or a 2-tuple.&quot;</span>
		<span class="c"># calculate reverse factor, and cause nice ZeroDivisionError if it can&#39;t</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="n">reverse</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">factor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">factor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">reverse</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">factor</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mul__</span><span class="p">(</span><span class="n">reverse</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseGlyph</span><span class="p">),</span> <span class="s">&quot;Glyphs can only be added to other glyphs.&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processMathOne</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">addPt</span><span class="p">)</span>
		<span class="n">data</span><span class="p">[</span><span class="s">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">width</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setMathData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseGlyph</span><span class="p">),</span> <span class="s">&quot;Glyphs can only be substracted from other glyphs.&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processMathOne</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">subPt</span><span class="p">)</span>
		<span class="n">data</span><span class="p">[</span><span class="s">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">width</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setMathData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
	
	<span class="c">#</span>
	<span class="c"># Interpolation</span>
	<span class="c">#</span>
	
<div class="viewcode-block" id="BaseGlyph.interpolate"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.interpolate">[docs]</a>	<span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">minGlyph</span><span class="p">,</span> <span class="n">maxGlyph</span><span class="p">,</span> <span class="n">suppressError</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">analyzeOnly</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Traditional interpolation method. Interpolates by factor between minGlyph and maxGlyph.</span>
<span class="sd">		suppressError will supress all tracebacks and analyze only will not perform the interpolation</span>
<span class="sd">		but it will analyze all glyphs and return a dict of problems.&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span><span class="p">,</span> <span class="n">factor</span>
		<span class="n">fatalError</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
			<span class="n">ok</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">minGlyph</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span><span class="n">maxGlyph</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">ok</span><span class="p">,</span> <span class="n">errors</span>
		<span class="n">minData</span> <span class="o">=</span> <span class="bp">None</span>
		<span class="n">maxData</span> <span class="o">=</span> <span class="bp">None</span>
		<span class="n">minName</span> <span class="o">=</span> <span class="n">minGlyph</span><span class="o">.</span><span class="n">name</span>
		<span class="n">maxName</span> <span class="o">=</span> <span class="n">maxGlyph</span><span class="o">.</span><span class="n">name</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">minData</span> <span class="o">=</span> <span class="n">minGlyph</span><span class="o">.</span><span class="n">_getMathData</span><span class="p">()</span>
			<span class="n">maxData</span> <span class="o">=</span> <span class="n">maxGlyph</span><span class="o">.</span><span class="n">_getMathData</span><span class="p">()</span>
			<span class="n">newContours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolateContours</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">minData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">],</span> <span class="n">maxData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">])</span>
			<span class="n">newComponents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolateComponents</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">minData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">],</span> <span class="n">maxData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">])</span>
			<span class="n">newAnchors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolateAnchors</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">minData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">],</span> <span class="n">maxData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">])</span>
			<span class="n">newWidth</span> <span class="o">=</span> <span class="n">_interpolate</span><span class="p">(</span><span class="n">minGlyph</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">maxGlyph</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">factor</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">newData</span> <span class="o">=</span> <span class="p">{</span>
					<span class="s">&#39;contours&#39;</span><span class="p">:</span><span class="n">newContours</span><span class="p">,</span>
					<span class="s">&#39;components&#39;</span><span class="p">:</span><span class="n">newComponents</span><span class="p">,</span>
					<span class="s">&#39;anchors&#39;</span><span class="p">:</span><span class="n">newAnchors</span><span class="p">,</span>
					<span class="s">&#39;width&#39;</span><span class="p">:</span><span class="n">newWidth</span>
					<span class="p">}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_setMathData</span><span class="p">(</span><span class="n">newData</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">suppressError</span><span class="p">:</span>
				<span class="n">ok</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">minGlyph</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span><span class="n">maxGlyph</span><span class="p">)</span>
				<span class="n">ok</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ok</span>
				<span class="k">return</span> <span class="n">ok</span><span class="p">,</span> <span class="n">errors</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
		<span class="k">return</span> <span class="bp">False</span><span class="p">,</span> <span class="p">[]</span>
	</div>
<div class="viewcode-block" id="BaseGlyph.isCompatible"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.isCompatible">[docs]</a>	<span class="k">def</span> <span class="nf">isCompatible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otherGlyph</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Return a bool value if the glyph is compatible with otherGlyph.</span>
<span class="sd">		With report = True, isCompatible will return a report of what&#39;s wrong.</span>
<span class="sd">		The interpolate method requires absolute equality between contour data.</span>
<span class="sd">		Absolute equality is preferred among component and anchor data, but</span>
<span class="sd">		it is NOT required. Interpolation between components and anchors</span>
<span class="sd">		will only deal with compatible data and incompatible data will be</span>
<span class="sd">		ignored. This method reflects this system.&quot;&quot;&quot;</span>
		<span class="n">selfName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
		<span class="n">selfData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMathData</span><span class="p">()</span>
		<span class="n">otherName</span> <span class="o">=</span> <span class="n">otherGlyph</span><span class="o">.</span><span class="n">name</span>
		<span class="n">otherData</span> <span class="o">=</span> <span class="n">otherGlyph</span><span class="o">.</span><span class="n">_getMathData</span><span class="p">()</span>
		<span class="n">compatible</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isCompatibleInternal</span><span class="p">(</span><span class="n">selfName</span><span class="p">,</span> <span class="n">otherName</span><span class="p">,</span> <span class="n">selfData</span><span class="p">,</span> <span class="n">otherData</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">report</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">compatible</span><span class="p">,</span> <span class="n">errors</span>
		<span class="k">return</span> <span class="n">compatible</span>
				</div>
	<span class="k">def</span> <span class="nf">_isCompatibleInternal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selfName</span><span class="p">,</span> <span class="n">otherName</span><span class="p">,</span> <span class="n">selfData</span><span class="p">,</span> <span class="n">otherData</span><span class="p">):</span>
		<span class="n">fatalError</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="c">## contours</span>
		<span class="c"># any contour incompatibilities</span>
		<span class="c"># result in fatal errors</span>
		<span class="n">selfContours</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">]</span>
		<span class="n">otherContours</span> <span class="o">=</span> <span class="n">otherData</span><span class="p">[</span><span class="s">&#39;contours&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfContours</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherContours</span><span class="p">):</span>
			<span class="n">fatalError</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Fatal error: glyph </span><span class="si">%s</span><span class="s"> and glyph </span><span class="si">%s</span><span class="s"> don&#39;t have the same number of contours.&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">selfName</span><span class="p">,</span> <span class="n">otherName</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">contourIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selfContours</span><span class="p">)):</span>
				<span class="n">selfContour</span> <span class="o">=</span> <span class="n">selfContours</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span>
				<span class="n">otherContour</span> <span class="o">=</span> <span class="n">otherContours</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfContour</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherContour</span><span class="p">):</span>
					<span class="n">fatalError</span> <span class="o">=</span> <span class="bp">True</span>
					<span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Fatal error: contour </span><span class="si">%d</span><span class="s"> in glyph </span><span class="si">%s</span><span class="s"> and glyph </span><span class="si">%s</span><span class="s"> don&#39;t have the same number of segments.&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">contourIndex</span><span class="p">,</span> <span class="n">selfName</span><span class="p">,</span> <span class="n">otherName</span><span class="p">))</span>
		<span class="c">## components</span>
		<span class="c"># component incompatibilities</span>
		<span class="c"># do not result in fatal errors</span>
		<span class="n">selfComponents</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">]</span>
		<span class="n">otherComponents</span> <span class="o">=</span> <span class="n">otherData</span><span class="p">[</span><span class="s">&#39;components&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfComponents</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherComponents</span><span class="p">):</span>
			<span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Error: glyph </span><span class="si">%s</span><span class="s"> and glyph </span><span class="si">%s</span><span class="s"> don&#39;t have the same number of components.&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">selfName</span><span class="p">,</span> <span class="n">otherName</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">componentIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selfComponents</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherComponents</span><span class="p">))):</span>
			<span class="n">selfBaseName</span><span class="p">,</span> <span class="n">selfTransformation</span> <span class="o">=</span> <span class="n">selfComponents</span><span class="p">[</span><span class="n">componentIndex</span><span class="p">]</span>
			<span class="n">otherBaseName</span><span class="p">,</span> <span class="n">otherTransformation</span> <span class="o">=</span> <span class="n">otherComponents</span><span class="p">[</span><span class="n">componentIndex</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">selfBaseName</span> <span class="o">!=</span> <span class="n">otherBaseName</span><span class="p">:</span>
				<span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Error: component </span><span class="si">%d</span><span class="s"> in glyph </span><span class="si">%s</span><span class="s"> and glyph </span><span class="si">%s</span><span class="s"> don&#39;t have the same base glyph.&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">componentIndex</span><span class="p">,</span> <span class="n">selfName</span><span class="p">,</span> <span class="n">otherName</span><span class="p">))</span>
		<span class="c">## anchors</span>
		<span class="c"># anchor incompatibilities</span>
		<span class="c"># do not result in fatal errors</span>
		<span class="n">selfAnchors</span> <span class="o">=</span> <span class="n">selfData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">]</span>
		<span class="n">otherAnchors</span> <span class="o">=</span> <span class="n">otherData</span><span class="p">[</span><span class="s">&#39;anchors&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selfAnchors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherAnchors</span><span class="p">):</span>
			<span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Error: glyph </span><span class="si">%s</span><span class="s"> and glyph </span><span class="si">%s</span><span class="s"> don&#39;t have the same number of anchors.&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">selfName</span><span class="p">,</span> <span class="n">otherName</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">anchorIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selfAnchors</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherAnchors</span><span class="p">))):</span>
			<span class="n">selfPt</span><span class="p">,</span> <span class="n">selfAnchorName</span> <span class="o">=</span> <span class="n">selfAnchors</span><span class="p">[</span><span class="n">anchorIndex</span><span class="p">]</span>
			<span class="n">otherPt</span><span class="p">,</span> <span class="n">otherAnchorName</span> <span class="o">=</span> <span class="n">otherAnchors</span><span class="p">[</span><span class="n">anchorIndex</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">selfAnchorName</span> <span class="o">!=</span> <span class="n">otherAnchorName</span><span class="p">:</span>
				<span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Error: anchor </span><span class="si">%d</span><span class="s"> in glyph </span><span class="si">%s</span><span class="s"> and glyph </span><span class="si">%s</span><span class="s"> don&#39;t have the same name.&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">anchorIndex</span><span class="p">,</span> <span class="n">selfName</span><span class="p">,</span> <span class="n">otherName</span><span class="p">))</span>
		<span class="k">return</span> <span class="ow">not</span> <span class="n">fatalError</span><span class="p">,</span> <span class="n">errors</span>
	
	<span class="k">def</span> <span class="nf">_interpolateContours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">minContours</span><span class="p">,</span> <span class="n">maxContours</span><span class="p">):</span>
		<span class="n">newContours</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">contourIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">minContours</span><span class="p">)):</span>
			<span class="n">minContour</span> <span class="o">=</span> <span class="n">minContours</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span>
			<span class="n">maxContour</span> <span class="o">=</span> <span class="n">maxContours</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span>
			<span class="n">newContours</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
			<span class="k">for</span> <span class="n">pointIndex</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">minContour</span><span class="p">)):</span>
				<span class="n">segType</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">smooth</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">minContour</span><span class="p">[</span><span class="n">pointIndex</span><span class="p">]</span>
				<span class="n">minPoint</span> <span class="o">=</span> <span class="n">minContour</span><span class="p">[</span><span class="n">pointIndex</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
				<span class="n">maxPoint</span> <span class="o">=</span> <span class="n">maxContour</span><span class="p">[</span><span class="n">pointIndex</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
				<span class="n">newX</span><span class="p">,</span> <span class="n">newY</span> <span class="o">=</span> <span class="n">_interpolatePt</span><span class="p">(</span><span class="n">minPoint</span><span class="p">,</span> <span class="n">maxPoint</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
				<span class="n">newContours</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">segType</span><span class="p">,</span> <span class="p">(</span><span class="n">newX</span><span class="p">,</span> <span class="n">newY</span><span class="p">),</span> <span class="n">smooth</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">newContours</span>

	<span class="k">def</span> <span class="nf">_interpolateComponents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">minComponents</span><span class="p">,</span> <span class="n">maxComponents</span><span class="p">):</span>
		<span class="n">newComponents</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">minComponents</span><span class="p">,</span> <span class="n">maxComponents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mathComponentCompare</span><span class="p">(</span><span class="n">minComponents</span><span class="p">,</span> <span class="n">maxComponents</span><span class="p">)</span>
		<span class="n">componentNames</span> <span class="o">=</span> <span class="n">minComponents</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">componentName</span> <span class="ow">in</span> <span class="n">componentNames</span><span class="p">:</span>
			<span class="n">minComponentList</span> <span class="o">=</span> <span class="n">minComponents</span><span class="p">[</span><span class="n">componentName</span><span class="p">]</span>
			<span class="n">maxComponentList</span> <span class="o">=</span> <span class="n">maxComponents</span><span class="p">[</span><span class="n">componentName</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">minComponentList</span><span class="p">)):</span>
				<span class="c"># transformation breakdown: xScale, xyScale, yxScale, yScale, xOffset, yOffset</span>
				<span class="n">minXScale</span><span class="p">,</span> <span class="n">minXYScale</span><span class="p">,</span> <span class="n">minYXScale</span><span class="p">,</span> <span class="n">minYScale</span><span class="p">,</span> <span class="n">minXOffset</span><span class="p">,</span> <span class="n">minYOffset</span> <span class="o">=</span> <span class="n">minComponentList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="n">maxXScale</span><span class="p">,</span> <span class="n">maxXYScale</span><span class="p">,</span> <span class="n">maxYXScale</span><span class="p">,</span> <span class="n">maxYScale</span><span class="p">,</span> <span class="n">maxXOffset</span><span class="p">,</span> <span class="n">maxYOffset</span> <span class="o">=</span> <span class="n">maxComponentList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="n">newXScale</span><span class="p">,</span> <span class="n">newXYScale</span> <span class="o">=</span> <span class="n">_interpolatePt</span><span class="p">((</span><span class="n">minXScale</span><span class="p">,</span> <span class="n">minXYScale</span><span class="p">),</span> <span class="p">(</span><span class="n">maxXScale</span><span class="p">,</span> <span class="n">maxXYScale</span><span class="p">),</span> <span class="n">factor</span><span class="p">)</span>
				<span class="n">newYXScale</span><span class="p">,</span> <span class="n">newYScale</span> <span class="o">=</span> <span class="n">_interpolatePt</span><span class="p">((</span><span class="n">minYXScale</span><span class="p">,</span> <span class="n">minYScale</span><span class="p">),</span> <span class="p">(</span><span class="n">maxYXScale</span><span class="p">,</span> <span class="n">maxYScale</span><span class="p">),</span> <span class="n">factor</span><span class="p">)</span>
				<span class="n">newXOffset</span><span class="p">,</span> <span class="n">newYOffset</span> <span class="o">=</span> <span class="n">_interpolatePt</span><span class="p">((</span><span class="n">minXOffset</span><span class="p">,</span> <span class="n">minYOffset</span><span class="p">),</span> <span class="p">(</span><span class="n">maxXOffset</span><span class="p">,</span> <span class="n">maxYOffset</span><span class="p">),</span> <span class="n">factor</span><span class="p">)</span>
				<span class="n">newComponents</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">componentName</span><span class="p">,</span> <span class="p">(</span><span class="n">newXScale</span><span class="p">,</span> <span class="n">newXYScale</span><span class="p">,</span> <span class="n">newYXScale</span><span class="p">,</span> <span class="n">newYScale</span><span class="p">,</span> <span class="n">newXOffset</span><span class="p">,</span> <span class="n">newYOffset</span><span class="p">)))</span>
		<span class="k">return</span> <span class="n">newComponents</span>

	<span class="k">def</span> <span class="nf">_interpolateAnchors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">minAnchors</span><span class="p">,</span> <span class="n">maxAnchors</span><span class="p">):</span>
		<span class="n">newAnchors</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">minAnchors</span><span class="p">,</span> <span class="n">maxAnchors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mathAnchorCompare</span><span class="p">(</span><span class="n">minAnchors</span><span class="p">,</span> <span class="n">maxAnchors</span><span class="p">)</span>
		<span class="n">anchorNames</span> <span class="o">=</span> <span class="n">minAnchors</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">anchorName</span> <span class="ow">in</span> <span class="n">anchorNames</span><span class="p">:</span>
			<span class="n">minAnchorList</span> <span class="o">=</span> <span class="n">minAnchors</span><span class="p">[</span><span class="n">anchorName</span><span class="p">]</span>
			<span class="n">maxAnchorList</span> <span class="o">=</span> <span class="n">maxAnchors</span><span class="p">[</span><span class="n">anchorName</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">minAnchorList</span><span class="p">)):</span>
				<span class="n">minAnchor</span> <span class="o">=</span> <span class="n">minAnchorList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="n">maxAnchor</span> <span class="o">=</span> <span class="n">maxAnchorList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="n">newAnchor</span> <span class="o">=</span> <span class="n">_interpolatePt</span><span class="p">(</span><span class="n">minAnchor</span><span class="p">,</span> <span class="n">maxAnchor</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
				<span class="n">newAnchors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">newAnchor</span><span class="p">,</span> <span class="n">anchorName</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">newAnchors</span>
	
	<span class="c">#</span>
	<span class="c"># comparisons</span>
	<span class="c">#</span>

	<span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseGlyph</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getDigest</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_getDigest</span><span class="p">()</span>
		<span class="k">return</span> <span class="bp">False</span>

	<span class="k">def</span> <span class="nf">_getDigest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pointsOnly</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Calculate a digest of coordinates, points, things in this glyph.</span>
<span class="sd">		With pointsOnly == True the digest consists of a flat tuple of all</span>
<span class="sd">		coordinate pairs in the glyph, without the order of contours.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">robofab.pens.digestPen</span> <span class="kn">import</span> <span class="n">DigestPointPen</span>
		<span class="n">mp</span> <span class="o">=</span> <span class="n">DigestPointPen</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">pointsOnly</span><span class="p">:</span>
			<span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">|</span><span class="si">%d</span><span class="s">|</span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">getDigestPointsOnly</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">|</span><span class="si">%d</span><span class="s">|</span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">getDigest</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">_getStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Calculate a digest of points, things in this glyph, but NOT coordinates.&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">robofab.pens.digestPen</span> <span class="kn">import</span> <span class="n">DigestPointStructurePen</span>
		<span class="n">mp</span> <span class="o">=</span> <span class="n">DigestPointStructurePen</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">mp</span><span class="o">.</span><span class="n">getDigest</span><span class="p">()</span>
	
	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;mark the object and it&#39;s parent as changed&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
	
	<span class="k">def</span> <span class="nf">_get_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">bounds</span> <span class="o">=</span> <span class="n">_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontObject</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="k">return</span> <span class="n">bounds</span>
	
	<span class="n">box</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_box</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the bounding box of the glyph: (xMin, yMin, xMax, yMax)&quot;</span><span class="p">)</span>
			
	<span class="k">def</span> <span class="nf">_get_leftMargin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
			<span class="k">return</span> <span class="mi">0</span>
		<span class="n">xMin</span><span class="p">,</span> <span class="n">yMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">yMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span>
		<span class="k">return</span> <span class="n">xMin</span>
		
	<span class="k">def</span> <span class="nf">_set_leftMargin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">value</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">diff</span> <span class="o">=</span> <span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftMargin</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">diff</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">diff</span>
	
	<span class="n">leftMargin</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_leftMargin</span><span class="p">,</span> <span class="n">_set_leftMargin</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the left margin&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_rightMargin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
		<span class="n">xMin</span><span class="p">,</span> <span class="n">yMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">yMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">xMax</span>
		
	<span class="k">def</span> <span class="nf">_set_rightMargin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">xMin</span><span class="p">,</span> <span class="n">yMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">yMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">xMax</span> <span class="o">+</span> <span class="n">value</span>

	<span class="n">rightMargin</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rightMargin</span><span class="p">,</span> <span class="n">_set_rightMargin</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the right margin&quot;</span><span class="p">)</span>
	
<div class="viewcode-block" id="BaseGlyph.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this glyph&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="n">dont</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;_object&#39;</span><span class="p">,</span> <span class="s">&#39;getParent&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dont</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;contours&quot;</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
					<span class="n">dup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
			<span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;components&quot;</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
					<span class="n">dup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
			<span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;anchors&quot;</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchors</span><span class="p">:</span>
					<span class="n">dup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
			<span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;psHints&quot;</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">psHints</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">RBaseObject</span><span class="p">,</span> <span class="n">BaseLib</span><span class="p">)):</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dup</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
	</div>
	<span class="k">def</span> <span class="nf">_setParentTree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set the parents of all contained and dependent objects (and their dependents) right.&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
			<span class="n">item</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
			<span class="n">item</span><span class="o">.</span><span class="n">_setParentTree</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
			<span class="n">item</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchors</span><span class="p">:</span>
			<span class="n">item</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="BaseGlyph.getGlyph"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.getGlyph">[docs]</a>	<span class="k">def</span> <span class="nf">getGlyph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphName</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Provided there is a font parent for this glyph, return a sibling glyph.&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">glyphName</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()[</span><span class="n">glyphName</span><span class="p">]</span>
		<span class="k">return</span> <span class="bp">None</span>
		</div>
<div class="viewcode-block" id="BaseGlyph.getPen"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.getPen">[docs]</a>	<span class="k">def</span> <span class="nf">getPen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Return a Pen object for creating an outline in this glyph.&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">robofab.pens.adapterPens</span> <span class="kn">import</span> <span class="n">SegmentToPointPen</span>
		<span class="k">return</span> <span class="n">SegmentToPointPen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getPointPen</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="BaseGlyph.getPointPen"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.getPointPen">[docs]</a>	<span class="k">def</span> <span class="nf">getPointPen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Return a PointPen object for creating an outline in this glyph.&quot;&quot;&quot;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">,</span> <span class="s">&quot;getPointPen() must be implemented by subclass&quot;</span>
	</div>
<div class="viewcode-block" id="BaseGlyph.isEmpty"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.isEmpty">[docs]</a>	<span class="k">def</span> <span class="nf">isEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return true if the glyph has no contours or components&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">True</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">False</span>
	</div>
	<span class="k">def</span> <span class="nf">_saveToGlyphSet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphSet</span><span class="p">,</span> <span class="n">glyphName</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Save the glyph to GlyphSet, a private method that&#39;s part of the saving process.&quot;&quot;&quot;</span>
		<span class="c"># save stuff in the lib first</span>
		<span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">changed</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">glyphName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
				<span class="n">glyphName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
			<span class="n">glyphSet</span><span class="o">.</span><span class="n">writeGlyph</span><span class="p">(</span><span class="n">glyphName</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">)</span>
			
<div class="viewcode-block" id="BaseGlyph.update"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;update the glyph&quot;&quot;&quot;</span>
		<span class="k">pass</span>
	</div>
<div class="viewcode-block" id="BaseGlyph.draw"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.draw">[docs]</a>	<span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;draw the object with a RoboFab segment pen&quot;&quot;&quot;</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">note</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="n">pen</span><span class="o">.</span><span class="n">setNote</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">note</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
			<span class="c"># FontTools pens don&#39;t have these methods</span>
			<span class="k">pass</span>
		<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchors</span><span class="p">:</span>
			<span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
			<span class="n">c</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
			<span class="n">c</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">doneDrawing</span><span class="p">()</span>
		<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
			<span class="c"># FontTools pens don&#39;t have a doneDrawing() method</span>
			<span class="k">pass</span>
		</div>
<div class="viewcode-block" id="BaseGlyph.drawPoints"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.drawPoints">[docs]</a>	<span class="k">def</span> <span class="nf">drawPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;draw the object with a point pen&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchors</span><span class="p">:</span>
			<span class="n">a</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
			<span class="n">c</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
			<span class="n">c</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
	</div>
<div class="viewcode-block" id="BaseGlyph.appendContour"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.appendContour">[docs]</a>	<span class="k">def</span> <span class="nf">appendContour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aContour</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;append a contour to the glyph&quot;&quot;&quot;</span>
		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">offset</span>
		<span class="n">pen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPointPen</span><span class="p">()</span>
		<span class="n">aContour</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
	</div>
<div class="viewcode-block" id="BaseGlyph.appendGlyph"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.appendGlyph">[docs]</a>	<span class="k">def</span> <span class="nf">appendGlyph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aGlyph</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;append another glyph to the glyph&quot;&quot;&quot;</span>
		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">offset</span>
		<span class="n">pen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPointPen</span><span class="p">()</span>
		<span class="c">#to handle the offsets, move the source glyph and then move it back!</span>
		<span class="n">aGlyph</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
		<span class="n">aGlyph</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="n">aGlyph</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">))</span>
		</div>
<div class="viewcode-block" id="BaseGlyph.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;round all coordinates in all contours, components and anchors&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchors</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">))</span>
		</div>
<div class="viewcode-block" id="BaseGlyph.autoUnicodes"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.autoUnicodes">[docs]</a>	<span class="k">def</span> <span class="nf">autoUnicodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Using fontTools.agl, assign Unicode list to the glyph&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">fontTools.agl</span> <span class="kn">import</span> <span class="n">AGL2UV</span>
		<span class="k">if</span> <span class="n">AGL2UV</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">unicode</span> <span class="o">=</span> <span class="n">AGL2UV</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
			</div>
<div class="viewcode-block" id="BaseGlyph.pointInside"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.pointInside">[docs]</a>	<span class="k">def</span> <span class="nf">pointInside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">evenOdd</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;determine if the point is in the black or white of the glyph&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">fontTools.pens.pointInsidePen</span> <span class="kn">import</span> <span class="n">PointInsidePen</span>
		<span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="n">piPen</span> <span class="o">=</span> <span class="n">PointInsidePen</span><span class="p">(</span><span class="n">glyphSet</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">testPoint</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">evenOdd</span><span class="o">=</span><span class="n">evenOdd</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">piPen</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">piPen</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
	</div>
<div class="viewcode-block" id="BaseGlyph.correctDirection"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.correctDirection">[docs]</a>	<span class="k">def</span> <span class="nf">correctDirection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trueType</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;corect the direction of the contours in the glyph.&quot;&quot;&quot;</span>
		<span class="c">#this is a bit slow, but i&#39;m not sure how much more it can be optimized.</span>
		<span class="c">#it also has a bug somewhere that is causeing some contours to be set incorrectly.</span>
		<span class="c">#try to run it on the copyright symbol to see the problem. hm.</span>
		<span class="c">#</span>
		<span class="c">#establish the default direction that an outer contour should follow</span>
		<span class="c">#i believe for TT this is clockwise and for PS it is counter</span>
		<span class="c">#i could be wrong about this, i need to double check.</span>
		<span class="kn">from</span> <span class="nn">fontTools.pens.pointInsidePen</span> <span class="kn">import</span> <span class="n">PointInsidePen</span>
		<span class="n">baseDirection</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">if</span> <span class="n">trueType</span><span class="p">:</span>
			<span class="n">baseDirection</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="c">#we don&#39;t need to do all the work if the contour count is &lt; 2</span>
		<span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">return</span>
		<span class="k">elif</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clockwise</span> <span class="o">=</span> <span class="n">baseDirection</span>
			<span class="k">return</span>
		<span class="c">#store up needed before we start</span>
		<span class="c">#i think the .box calls are eating a big chunk of the time</span>
		<span class="n">contourDict</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">contourIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">)):</span>
			<span class="n">contour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span>
			<span class="n">contourDict</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;box&#39;</span><span class="p">:</span><span class="n">contour</span><span class="o">.</span><span class="n">box</span><span class="p">,</span> <span class="s">&#39;dir&#39;</span><span class="p">:</span><span class="n">contour</span><span class="o">.</span><span class="n">clockwise</span><span class="p">,</span> <span class="s">&#39;hit&#39;</span><span class="p">:[],</span> <span class="s">&#39;notHit&#39;</span><span class="p">:[]}</span>
		<span class="c">#now, for every contour, determine which contours it intersects</span>
		<span class="c">#as we go, we will also store contours that it doesn&#39;t intersct</span>
		<span class="c">#and we store this value for both contours</span>
		<span class="n">allIndexes</span> <span class="o">=</span> <span class="n">contourDict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">contourIndex</span> <span class="ow">in</span> <span class="n">allIndexes</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">otherContourIndex</span> <span class="ow">in</span> <span class="n">allIndexes</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">otherContourIndex</span> <span class="o">!=</span> <span class="n">contourIndex</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">contourIndex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">contourDict</span><span class="p">[</span><span class="n">otherContourIndex</span><span class="p">][</span><span class="s">&#39;hit&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">contourIndex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">contourDict</span><span class="p">[</span><span class="n">otherContourIndex</span><span class="p">][</span><span class="s">&#39;notHit&#39;</span><span class="p">]:</span>
						<span class="n">xMin1</span><span class="p">,</span> <span class="n">yMin1</span><span class="p">,</span> <span class="n">xMax1</span><span class="p">,</span> <span class="n">yMax1</span> <span class="o">=</span> <span class="n">contourDict</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">][</span><span class="s">&#39;box&#39;</span><span class="p">]</span>
						<span class="n">xMin2</span><span class="p">,</span> <span class="n">yMin2</span><span class="p">,</span> <span class="n">xMax2</span><span class="p">,</span> <span class="n">yMax2</span><span class="o">=</span> <span class="n">contourDict</span><span class="p">[</span><span class="n">otherContourIndex</span><span class="p">][</span><span class="s">&#39;box&#39;</span><span class="p">]</span>	
						<span class="n">hit</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">sectRect</span><span class="p">((</span><span class="n">xMin1</span><span class="p">,</span> <span class="n">yMin1</span><span class="p">,</span> <span class="n">xMax1</span><span class="p">,</span> <span class="n">yMax1</span><span class="p">),</span> <span class="p">(</span><span class="n">xMin2</span><span class="p">,</span> <span class="n">yMin2</span><span class="p">,</span> <span class="n">xMax2</span><span class="p">,</span> <span class="n">yMax2</span><span class="p">))</span>
						<span class="k">if</span> <span class="n">hit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
							<span class="n">contourDict</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">][</span><span class="s">&#39;hit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">otherContourIndex</span><span class="p">)</span>
							<span class="n">contourDict</span><span class="p">[</span><span class="n">otherContourIndex</span><span class="p">][</span><span class="s">&#39;hit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contourIndex</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">contourDict</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">][</span><span class="s">&#39;notHit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">otherContourIndex</span><span class="p">)</span>
							<span class="n">contourDict</span><span class="p">[</span><span class="n">otherContourIndex</span><span class="p">][</span><span class="s">&#39;notHit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contourIndex</span><span class="p">)</span>
		<span class="c">#set up the pen here to shave a bit of time</span>
		<span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="n">piPen</span> <span class="o">=</span> <span class="n">PointInsidePen</span><span class="p">(</span><span class="n">glyphSet</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">testPoint</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">evenOdd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
		<span class="c">#now do the pointInside work</span>
		<span class="k">for</span> <span class="n">contourIndex</span> <span class="ow">in</span> <span class="n">allIndexes</span><span class="p">:</span>
			<span class="n">direction</span> <span class="o">=</span> <span class="n">baseDirection</span>
			<span class="n">contour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">]</span>
			<span class="n">startPoint</span> <span class="o">=</span> <span class="n">contour</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="k">if</span> <span class="n">startPoint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>	<span class="c">#skip TT paths with no onCurve</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contourDict</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">][</span><span class="s">&#39;hit&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">otherContourIndex</span> <span class="ow">in</span> <span class="n">contourDict</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">][</span><span class="s">&#39;hit&#39;</span><span class="p">]:</span>
						<span class="n">piPen</span><span class="o">.</span><span class="n">setTestPoint</span><span class="p">(</span><span class="n">testPoint</span><span class="o">=</span><span class="p">(</span><span class="n">startPoint</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">startPoint</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
						<span class="n">otherContour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">[</span><span class="n">otherContourIndex</span><span class="p">]</span>
						<span class="n">otherContour</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">piPen</span><span class="p">)</span>
						<span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">+</span> <span class="n">piPen</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
			<span class="n">newDirection</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">%</span> <span class="mi">2</span>
			<span class="c">#now set the direction if we need to</span>
			<span class="k">if</span> <span class="n">newDirection</span> <span class="o">!=</span> <span class="n">contourDict</span><span class="p">[</span><span class="n">contourIndex</span><span class="p">][</span><span class="s">&#39;dir&#39;</span><span class="p">]:</span>
				<span class="n">contour</span><span class="o">.</span><span class="n">reverseContour</span><span class="p">()</span>
	</div>
<div class="viewcode-block" id="BaseGlyph.autoContourOrder"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.autoContourOrder">[docs]</a>	<span class="k">def</span> <span class="nf">autoContourOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;attempt to sort the contours based on their centers&quot;&quot;&quot;</span>
		<span class="c"># sort is based on (in this order):</span>
		<span class="c"># - the (negative) point count</span>
		<span class="c"># - the (negative) segment count</span>
		<span class="c"># - fuzzy x value of the center of the contour</span>
		<span class="c"># - fuzzy y value of the center of the contour</span>
		<span class="c"># - the (negative) surface of the bounding box of the contour: width * height</span>
		<span class="c"># the latter is a safety net for for instances like a very thin &#39;O&#39; where the</span>
		<span class="c"># x centers could be close enough to rely on the y for the sort which could</span>
		<span class="c"># very well be the same for both contours. We use the _negative_ of the surface</span>
		<span class="c"># to ensure that larger contours appear first, which seems more natural.</span>
		<span class="n">tempContourList</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">contourList</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">xThreshold</span> <span class="o">=</span> <span class="bp">None</span>
		<span class="n">yThreshold</span> <span class="o">=</span> <span class="bp">None</span>
		<span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
			<span class="n">xMin</span><span class="p">,</span> <span class="n">yMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">yMax</span> <span class="o">=</span> <span class="n">contour</span><span class="o">.</span><span class="n">box</span>
			<span class="n">width</span> <span class="o">=</span> <span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span>
			<span class="n">height</span> <span class="o">=</span> <span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span>
			<span class="n">xC</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">xMin</span> <span class="o">+</span> <span class="n">xMax</span><span class="p">)</span>
			<span class="n">yC</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">yMin</span> <span class="o">+</span> <span class="n">yMax</span><span class="p">)</span>
			<span class="n">xTh</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
			<span class="n">yTh</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">height</span> <span class="o">*</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">xThreshold</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">xThreshold</span> <span class="o">&gt;</span> <span class="n">xTh</span><span class="p">:</span>
				<span class="n">xThreshold</span> <span class="o">=</span> <span class="n">xTh</span>
			<span class="k">if</span> <span class="n">yThreshold</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">yThreshold</span> <span class="o">&gt;</span> <span class="n">yTh</span><span class="p">:</span>
				<span class="n">yThreshold</span> <span class="o">=</span> <span class="n">yTh</span>
			<span class="n">tempContourList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">contour</span><span class="o">.</span><span class="n">points</span><span class="p">),</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">contour</span><span class="o">.</span><span class="n">segments</span><span class="p">),</span> <span class="n">xC</span><span class="p">,</span> <span class="n">yC</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="p">),</span> <span class="n">contour</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">points</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">contour</span> <span class="ow">in</span> <span class="n">tempContourList</span><span class="p">:</span>
			<span class="n">contourList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">points</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">FuzzyNumber</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xThreshold</span><span class="p">),</span> <span class="n">FuzzyNumber</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yThreshold</span><span class="p">),</span> <span class="n">surface</span><span class="p">,</span> <span class="n">contour</span><span class="p">))</span>
		<span class="n">contourList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contourList</span><span class="p">)):</span>
			<span class="n">points</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">xO</span><span class="p">,</span> <span class="n">yO</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">contour</span> <span class="o">=</span> <span class="n">contourList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">contour</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
	</div>
<div class="viewcode-block" id="BaseGlyph.move"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.move">[docs]</a>	<span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">contours</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">anchors</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Move a glyph&#39;s items that are flagged as True&quot;&quot;&quot;</span>
		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">roundPt</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
			<span class="n">contour</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
			<span class="n">component</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">anchor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchors</span><span class="p">:</span>
			<span class="n">anchor</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
			</div>
<div class="viewcode-block" id="BaseGlyph.scale"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.scale">[docs]</a>	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;scale the glyph&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
			<span class="n">contour</span><span class="o">.</span><span class="n">scale</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
			<span class="n">offset</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">offset</span>
			<span class="n">component</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">_scalePointFromCenter</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="p">)</span>
			<span class="n">sX</span><span class="p">,</span> <span class="n">sY</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">scale</span>
			<span class="n">component</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">sX</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">sY</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">anchor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchors</span><span class="p">:</span>
			<span class="n">anchor</span><span class="o">.</span><span class="n">scale</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseGlyph.transform"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.transform">[docs]</a>	<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Transform this glyph.</span>
<span class="sd">		Use a Transform matrix object from</span>
<span class="sd">		robofab.transform&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
			<span class="n">c</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchors</span><span class="p">:</span>
			<span class="n">a</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
			</div>
<div class="viewcode-block" id="BaseGlyph.rotate"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.rotate">[docs]</a>	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;rotate the glyph&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">fontTools.misc.transform</span> <span class="kn">import</span> <span class="n">Identity</span>
		<span class="n">radAngle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">/</span> <span class="n">DEGREE</span>	<span class="c"># convert from degrees to radians</span>
		<span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">rT</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">radAngle</span><span class="p">)</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">rT</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">-</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rT</span><span class="p">)</span>	
	</div>
<div class="viewcode-block" id="BaseGlyph.skew"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGlyph.skew">[docs]</a>	<span class="k">def</span> <span class="nf">skew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;skew the glyph&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">fontTools.misc.transform</span> <span class="kn">import</span> <span class="n">Identity</span>
		<span class="n">radAngle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">/</span> <span class="n">DEGREE</span>	<span class="c"># convert from degrees to radians</span>
		<span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">rT</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">radAngle</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rT</span><span class="p">)</span>
	
	</div></div>
<div class="viewcode-block" id="BaseContour"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour">[docs]</a><span class="k">class</span> <span class="nc">BaseContour</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all contour objects.&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">RBaseObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="c">#self.index = None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
		
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="s">&quot;unnamed_glyph&quot;</span>
		<span class="n">glyphParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">glyphParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">glyph</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">name</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
			<span class="n">fontParent</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
				<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">idx</span> <span class="o">=</span> <span class="sb">`self.index`</span>
		<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
			<span class="c"># XXXX</span>
			<span class="n">idx</span> <span class="o">=</span> <span class="s">&quot;XXX&quot;</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RContour for </span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">[</span><span class="si">%s</span><span class="s">]&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
		
	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;mark the object and it&#39;s parent as changed&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
	
	<span class="k">def</span> <span class="nf">_nextSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segmentIndex</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[(</span><span class="n">segmentIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">)]</span>
	
	<span class="k">def</span> <span class="nf">_prevSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segmentIndex</span><span class="p">):</span>
		<span class="n">segments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[(</span><span class="n">segmentIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">)]</span>
		
	<span class="k">def</span> <span class="nf">_get_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">bounds</span> <span class="o">=</span> <span class="n">_box</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">bounds</span>
	
	<span class="n">box</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_box</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the bounding box for the contour&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_set_clockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clockwise</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">reverseContour</span><span class="p">()</span>
			
	<span class="k">def</span> <span class="nf">_get_clockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">anchors</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">lastOn</span> <span class="o">=</span> <span class="bp">None</span>
		<span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">:</span>
			<span class="n">anchor</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="n">anchor</span> <span class="o">=</span> <span class="p">(</span><span class="n">anchor</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">anchor</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
			<span class="c"># overlapping points can give false results, so filter them out</span>
			<span class="k">if</span> <span class="n">anchor</span> <span class="o">==</span> <span class="n">lastOn</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="n">anchors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">anchor</span><span class="p">)</span>
			<span class="n">lastOn</span> <span class="o">=</span> <span class="n">anchor</span>
		<span class="c">#overlapping moves can give false results, so filter them out</span>
		<span class="n">first</span> <span class="o">=</span> <span class="n">anchors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">last</span> <span class="o">=</span> <span class="n">anchors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">first</span> <span class="o">==</span> <span class="n">last</span><span class="p">:</span>
			<span class="k">del</span> <span class="n">anchors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">nPoints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">anchors</span><span class="p">)</span>
		<span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nPoints</span><span class="p">):</span>
			<span class="n">i2</span> <span class="o">=</span> <span class="p">(</span><span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">nPoints</span>
			<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">anchors</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
			<span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">anchors</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span>
			<span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">))</span>
		<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">pi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
		<span class="n">pi2</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span>
		<span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nPoints</span><span class="p">):</span>
			<span class="n">i2</span> <span class="o">=</span> <span class="p">(</span><span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">nPoints</span>
			<span class="n">d</span> <span class="o">=</span> <span class="p">((</span><span class="n">angles</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">-</span> <span class="n">angles</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="n">pi2</span><span class="p">)</span> <span class="o">-</span> <span class="n">pi</span>
			<span class="n">total</span> <span class="o">+=</span> <span class="n">d</span>
		<span class="k">return</span> <span class="n">total</span> <span class="o">&lt;</span> <span class="mi">0</span>

	<span class="n">clockwise</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_clockwise</span><span class="p">,</span> <span class="n">_set_clockwise</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;direction of contour: 1=clockwise 0=counterclockwise&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="BaseContour.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this contour&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="n">dont</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;_object&#39;</span><span class="p">,</span> <span class="s">&#39;points&#39;</span><span class="p">,</span> <span class="s">&#39;bPoints&#39;</span><span class="p">,</span> <span class="s">&#39;getParent&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dont</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;segments&quot;</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">:</span>
					<span class="n">dup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">RBaseObject</span><span class="p">,</span> <span class="n">BaseLib</span><span class="p">)):</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dup</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
		</div>
	<span class="k">def</span> <span class="nf">_setParentTree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set the parents of all contained and dependent objects (and their dependents) right.&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">:</span>
			<span class="n">item</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="BaseContour.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;round the value of all points in the contour&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
	</div>
<div class="viewcode-block" id="BaseContour.draw"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.draw">[docs]</a>	<span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;draw the object with a fontTools pen&quot;&quot;&quot;</span>
		<span class="n">firstOn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">onCurve</span>
		<span class="n">firstType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
		<span class="n">lastOn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onCurve</span>
		<span class="c"># this is a special exception for FontLab</span>
		<span class="c"># FL can have a contour that does not contain a move.</span>
		<span class="c"># this will only happen if the contour begins with a qcurve.</span>
		<span class="c"># in this case, we move to the segment&#39;s on curve,</span>
		<span class="c"># then we iterate through the rest of the points,</span>
		<span class="c"># then we add the first qcurve and finally we</span>
		<span class="c"># close the path. after this, i say &quot;ugh.&quot;</span>
		<span class="k">if</span> <span class="n">firstType</span> <span class="o">==</span> <span class="n">QCURVE</span><span class="p">:</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">moveTo</span><span class="p">((</span><span class="n">firstOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">firstOn</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
			<span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
				<span class="n">segmentType</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">type</span>
				<span class="n">pt</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span><span class="o">.</span><span class="n">y</span>
				<span class="k">if</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">LINE</span><span class="p">:</span>
					<span class="n">pen</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">CURVE</span><span class="p">:</span>
					<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">points</span><span class="p">]</span>
					<span class="n">pen</span><span class="o">.</span><span class="n">curveTo</span><span class="p">(</span><span class="o">*</span><span class="n">pts</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">QCURVE</span><span class="p">:</span>
					<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">points</span><span class="p">]</span>
					<span class="n">pen</span><span class="o">.</span><span class="n">qCurveTo</span><span class="p">(</span><span class="o">*</span><span class="n">pts</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">assert</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;unsupported segment type&quot;</span>
			<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">points</span><span class="p">]</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">qCurveTo</span><span class="p">(</span><span class="o">*</span><span class="n">pts</span><span class="p">)</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">closePath</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">firstType</span> <span class="o">==</span> <span class="n">MOVE</span> <span class="ow">and</span> <span class="p">(</span><span class="n">firstOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">firstOn</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">lastOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">lastOn</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
				<span class="n">closed</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">closed</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">:</span>
				<span class="n">segmentType</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">type</span>
				<span class="n">pt</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span><span class="o">.</span><span class="n">y</span>
				<span class="k">if</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">MOVE</span><span class="p">:</span>
					<span class="n">pen</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">LINE</span><span class="p">:</span>
					<span class="n">pen</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">CURVE</span><span class="p">:</span>
					<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">points</span><span class="p">]</span>
					<span class="n">pen</span><span class="o">.</span><span class="n">curveTo</span><span class="p">(</span><span class="o">*</span><span class="n">pts</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">QCURVE</span><span class="p">:</span>
					<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">points</span><span class="p">]</span>
					<span class="n">pen</span><span class="o">.</span><span class="n">qCurveTo</span><span class="p">(</span><span class="o">*</span><span class="n">pts</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">assert</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;unsupported segment type&quot;</span>
			<span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
				<span class="n">pen</span><span class="o">.</span><span class="n">closePath</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">pen</span><span class="o">.</span><span class="n">endPath</span><span class="p">()</span>
	</div>
<div class="viewcode-block" id="BaseContour.drawPoints"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.drawPoints">[docs]</a>	<span class="k">def</span> <span class="nf">drawPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;draw the object with a point pen&quot;&quot;&quot;</span>
		<span class="n">pen</span><span class="o">.</span><span class="n">beginPath</span><span class="p">()</span>
		<span class="n">lastOn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onCurve</span>
		<span class="n">didLastOn</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="n">flQCurveException</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="n">lastIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">)):</span>
			<span class="n">segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">segmentType</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">type</span>
			<span class="c"># the new protocol states that we start with an onCurve</span>
			<span class="c"># so, if we have a move and a nd a last point overlapping,</span>
			<span class="c"># add the last point to the beginning and skip the move</span>
			<span class="k">if</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">MOVE</span> <span class="ow">and</span> <span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">lastOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">lastOn</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
				<span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onCurve</span>
				<span class="n">name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
				<span class="n">pen</span><span class="o">.</span><span class="n">addPoint</span><span class="p">((</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">point</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">smooth</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
				<span class="n">didLastOn</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="k">continue</span>
			<span class="c"># this is an exception for objectsFL</span>
			<span class="c"># the problem is that quad contours are</span>
			<span class="c"># represented differently that they are in</span>
			<span class="c"># objectsRF:</span>
			<span class="c">#	FL: [qcurve, qcurve, qcurve, qcurve]</span>
			<span class="c">#	RF: [move, qcurve, qcurve, qcurve, qcurve]</span>
			<span class="c"># so, we need to catch this, and shift the offCurves to</span>
			<span class="c"># to the end of the contour</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">QCURVE</span><span class="p">:</span>
				<span class="n">flQCurveException</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">if</span> <span class="n">segmentType</span> <span class="o">==</span> <span class="n">MOVE</span><span class="p">:</span>
				<span class="n">segmentType</span> <span class="o">=</span> <span class="n">LINE</span>
			<span class="c">## the offCurves</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">flQCurveException</span><span class="p">:</span>
				<span class="k">pass</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">offCurve</span><span class="p">:</span>
					<span class="n">name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
					<span class="n">pen</span><span class="o">.</span><span class="n">addPoint</span><span class="p">((</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">segmentType</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">selected</span><span class="o">=</span><span class="n">point</span><span class="o">.</span><span class="n">selected</span><span class="p">)</span>
			<span class="c">## the onCurve</span>
			<span class="c"># skip the last onCurve if it was used as the move</span>
			<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">lastIndex</span> <span class="ow">and</span> <span class="n">didLastOn</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="n">point</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="n">name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">addPoint</span><span class="p">((</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">segmentType</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">segment</span><span class="o">.</span><span class="n">smooth</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">selected</span><span class="o">=</span><span class="n">point</span><span class="o">.</span><span class="n">selected</span><span class="p">)</span>
		<span class="c"># if we have the special qCurve case with objectsFL</span>
		<span class="c"># take care of the offCurves associated with the first contour</span>
		<span class="k">if</span> <span class="n">flQCurveException</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offCurve</span><span class="p">:</span>
				<span class="n">name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
				<span class="n">pen</span><span class="o">.</span><span class="n">addPoint</span><span class="p">((</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">segmentType</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">selected</span><span class="o">=</span><span class="n">point</span><span class="o">.</span><span class="n">selected</span><span class="p">)</span>
		<span class="n">pen</span><span class="o">.</span><span class="n">endPath</span><span class="p">()</span>
		</div>
<div class="viewcode-block" id="BaseContour.move"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.move">[docs]</a>	<span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;move the contour&quot;&quot;&quot;</span>
		<span class="c">#this will be faster if we go straight to the points</span>
		<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
			<span class="n">point</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
	</div>
<div class="viewcode-block" id="BaseContour.scale"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.scale">[docs]</a>	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;scale the contour&quot;&quot;&quot;</span>
		<span class="c">#this will be faster if we go straight to the points</span>
		<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
			<span class="n">point</span><span class="o">.</span><span class="n">scale</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">)</span>
	</div>
<div class="viewcode-block" id="BaseContour.transform"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.transform">[docs]</a>	<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Transform this contour.</span>
<span class="sd">		Use a Transform matrix object from</span>
<span class="sd">		robofab.transform&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">:</span>
			<span class="n">s</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
			</div>
<div class="viewcode-block" id="BaseContour.rotate"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.rotate">[docs]</a>	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;rotate the contour&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">fontTools.misc.transform</span> <span class="kn">import</span> <span class="n">Identity</span>
		<span class="n">radAngle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">/</span> <span class="n">DEGREE</span>	<span class="c"># convert from degrees to radians</span>
		<span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">rT</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">radAngle</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rT</span><span class="p">)</span>	
	</div>
<div class="viewcode-block" id="BaseContour.skew"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.skew">[docs]</a>	<span class="k">def</span> <span class="nf">skew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;skew the contour&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">fontTools.misc.transform</span> <span class="kn">import</span> <span class="n">Identity</span>
		<span class="n">radAngle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">/</span> <span class="n">DEGREE</span>	<span class="c"># convert from degrees to radians</span>
		<span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">Identity</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">rT</span> <span class="o">=</span> <span class="n">rT</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">radAngle</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rT</span><span class="p">)</span>
	</div>
<div class="viewcode-block" id="BaseContour.pointInside"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.pointInside">[docs]</a>	<span class="k">def</span> <span class="nf">pointInside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">evenOdd</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;determine if the point is inside or ouside of the contour&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">fontTools.pens.pointInsidePen</span> <span class="kn">import</span> <span class="n">PointInsidePen</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="n">font</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="n">piPen</span> <span class="o">=</span> <span class="n">PointInsidePen</span><span class="p">(</span><span class="n">glyphSet</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">testPoint</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">evenOdd</span><span class="o">=</span><span class="n">evenOdd</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">piPen</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">piPen</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
			</div>
<div class="viewcode-block" id="BaseContour.autoStartSegment"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.autoStartSegment">[docs]</a>	<span class="k">def</span> <span class="nf">autoStartSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;automatically set the lower left point of the contour as the first point.&quot;&quot;&quot;</span>
		<span class="c">#adapted from robofog</span>
		<span class="n">startIndex</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">startSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">)):</span>
			<span class="n">segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">startOn</span> <span class="o">=</span> <span class="n">startSegment</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="n">on</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="k">if</span> <span class="n">on</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">startOn</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">on</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">startOn</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">on</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">startOn</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
						<span class="n">startSegment</span> <span class="o">=</span> <span class="n">segment</span>
						<span class="n">startIndex</span> <span class="o">=</span> <span class="n">i</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">startSegment</span> <span class="o">=</span> <span class="n">segment</span>
					<span class="n">startIndex</span> <span class="o">=</span> <span class="n">i</span>
		<span class="k">if</span> <span class="n">startIndex</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">setStartSegment</span><span class="p">(</span><span class="n">startIndex</span><span class="p">)</span>
		</div>
<div class="viewcode-block" id="BaseContour.appendBPoint"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.appendBPoint">[docs]</a>	<span class="k">def</span> <span class="nf">appendBPoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pointType</span><span class="p">,</span> <span class="n">anchor</span><span class="p">,</span> <span class="n">bcpIn</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">bcpOut</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;append a bPoint to the contour&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">insertBPoint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">),</span> <span class="n">pointType</span><span class="o">=</span><span class="n">pointType</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor</span><span class="p">,</span> <span class="n">bcpIn</span><span class="o">=</span><span class="n">bcpIn</span><span class="p">,</span> <span class="n">bcpOut</span><span class="o">=</span><span class="n">bcpOut</span><span class="p">)</span>
		</div>
<div class="viewcode-block" id="BaseContour.insertBPoint"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseContour.insertBPoint">[docs]</a>	<span class="k">def</span> <span class="nf">insertBPoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">pointType</span><span class="p">,</span> <span class="n">anchor</span><span class="p">,</span> <span class="n">bcpIn</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">bcpOut</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;insert a bPoint at index on the contour&quot;&quot;&quot;</span>
		<span class="c">#insert a CURVE point that we can work with</span>
		<span class="n">nextSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nextSegment</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">QCURVE</span><span class="p">:</span>
			<span class="k">return</span>	
		<span class="k">if</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="n">prevSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
			<span class="n">prevOn</span> <span class="o">=</span> <span class="n">prevSegment</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="k">if</span> <span class="n">bcpIn</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
				<span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">appendSegment</span><span class="p">(</span><span class="n">CURVE</span><span class="p">,</span> <span class="p">[(</span><span class="n">prevOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">prevOn</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">absoluteBCPIn</span><span class="p">(</span><span class="n">anchor</span><span class="p">,</span> <span class="n">bcpIn</span><span class="p">),</span> <span class="n">anchor</span><span class="p">],</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">pointType</span> <span class="o">==</span> <span class="n">CURVE</span><span class="p">:</span>
					<span class="n">new</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">appendSegment</span><span class="p">(</span><span class="n">LINE</span><span class="p">,</span> <span class="p">[</span><span class="n">anchor</span><span class="p">],</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
			<span class="c">#if the user wants an outgoing bcp, we must add a CURVE ontop of the move</span>
			<span class="k">if</span> <span class="n">bcpOut</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
				<span class="n">nextOn</span> <span class="o">=</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">onCurve</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">appendSegment</span><span class="p">(</span><span class="n">CURVE</span><span class="p">,</span> <span class="p">[</span><span class="n">absoluteBCPOut</span><span class="p">(</span><span class="n">anchor</span><span class="p">,</span> <span class="n">bcpOut</span><span class="p">),</span> <span class="p">(</span><span class="n">nextOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">nextOn</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">nextOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">nextOn</span><span class="o">.</span><span class="n">y</span><span class="p">)],</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c">#handle the bcps</span>
			<span class="k">if</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">CURVE</span><span class="p">:</span>
				<span class="n">prevSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
				<span class="n">prevOn</span> <span class="o">=</span> <span class="n">prevSegment</span><span class="o">.</span><span class="n">onCurve</span>
				<span class="n">prevOutX</span><span class="p">,</span> <span class="n">prevOutY</span> <span class="o">=</span> <span class="p">(</span><span class="n">prevOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">prevOn</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">prevOut</span> <span class="o">=</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">prevOutX</span><span class="p">,</span> <span class="n">prevOutY</span> <span class="o">=</span> <span class="p">(</span><span class="n">prevOut</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">prevOut</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">insertSegment</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">segmentType</span><span class="o">=</span><span class="n">CURVE</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[(</span><span class="n">prevOutX</span><span class="p">,</span> <span class="n">prevOutY</span><span class="p">),</span> <span class="n">anchor</span><span class="p">,</span> <span class="n">anchor</span><span class="p">],</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
			<span class="n">newSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
			<span class="n">prevSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prevSegment</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
			<span class="n">nextSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nextSegment</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOVE</span><span class="p">:</span>
				<span class="k">raise</span> <span class="n">RoboFabError</span><span class="p">,</span> <span class="s">&#39;still working out curving at the end of a contour&#39;</span>
			<span class="k">elif</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">QCURVE</span><span class="p">:</span>
				<span class="k">return</span>
			<span class="c">#set the new incoming bcp</span>
			<span class="n">newIn</span> <span class="o">=</span> <span class="n">newSegment</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="n">nIX</span><span class="p">,</span> <span class="n">nIY</span> <span class="o">=</span> <span class="n">absoluteBCPIn</span><span class="p">(</span><span class="n">anchor</span><span class="p">,</span> <span class="n">bcpIn</span><span class="p">)</span>
			<span class="n">newIn</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">nIX</span>
			<span class="n">newIn</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">nIY</span>
			<span class="c">#set the new outgoing bcp</span>
			<span class="n">hasCurve</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">if</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">CURVE</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">bcpOut</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
					<span class="n">nextSegment</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">CURVE</span>
					<span class="n">hasCurve</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">hasCurve</span> <span class="o">=</span> <span class="bp">False</span>
			<span class="k">if</span> <span class="n">hasCurve</span><span class="p">:</span>
				<span class="n">newOut</span> <span class="o">=</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">nOX</span><span class="p">,</span> <span class="n">nOY</span> <span class="o">=</span> <span class="n">absoluteBCPOut</span><span class="p">(</span><span class="n">anchor</span><span class="p">,</span> <span class="n">bcpOut</span><span class="p">)</span>
				<span class="n">newOut</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">nOX</span>
				<span class="n">newOut</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">nOY</span>
			<span class="c">#now check to see if we can convert the CURVE segment to a LINE segment</span>
			<span class="n">newAnchor</span> <span class="o">=</span> <span class="n">newSegment</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="n">newA</span> <span class="o">=</span> <span class="n">newSegment</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">newB</span> <span class="o">=</span> <span class="n">newSegment</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="n">nextAnchor</span> <span class="o">=</span> <span class="n">nextSegment</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="n">prevAnchor</span> <span class="o">=</span> <span class="n">prevSegment</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">prevAnchor</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">prevAnchor</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">newA</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">newA</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">newAnchor</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">newAnchor</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">newB</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">newB</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
				<span class="n">newSegment</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">LINE</span>
			<span class="c">#the user wants a smooth segment		</span>
			<span class="k">if</span> <span class="n">pointType</span> <span class="o">==</span> <span class="n">CURVE</span><span class="p">:</span>
				<span class="n">newSegment</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="bp">True</span>

</div></div>
<div class="viewcode-block" id="BaseSegment"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseSegment">[docs]</a><span class="k">class</span> <span class="nc">BaseSegment</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all segment objects&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>
	
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="s">&quot;unnamed_glyph&quot;</span>
		<span class="n">contourIndex</span> <span class="o">=</span> <span class="s">&quot;unknown_contour&quot;</span>
		<span class="n">contourParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">contourParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">contourIndex</span> <span class="o">=</span> <span class="sb">`contourParent.index`</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
			<span class="n">glyphParent</span> <span class="o">=</span> <span class="n">contourParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">glyphParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">glyph</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">name</span>
				<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
				<span class="n">fontParent</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
					<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">idx</span> <span class="o">=</span> <span class="sb">`self.index`</span>
		<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
			<span class="n">idx</span> <span class="o">=</span> <span class="s">&quot;XXX&quot;</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RSegment for </span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">[</span><span class="si">%s</span><span class="s">][</span><span class="si">%s</span><span class="s">]&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">contourIndex</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
		
	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;mark the object and it&#39;s parent as changed&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
	
<div class="viewcode-block" id="BaseSegment.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseSegment.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this segment&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="n">dont</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;_object&#39;</span><span class="p">,</span> <span class="s">&#39;getParent&#39;</span><span class="p">,</span> <span class="s">&#39;offCurve&#39;</span><span class="p">,</span> <span class="s">&#39;onCurve&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dont</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;points&quot;</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
					<span class="n">dup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">RBaseObject</span><span class="p">,</span> <span class="n">BaseLib</span><span class="p">)):</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dup</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
	</div>
	<span class="k">def</span> <span class="nf">_setParentTree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set the parents of all contained and dependent objects (and their dependents) right.&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
			<span class="n">item</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="BaseSegment.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseSegment.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;round all points in the segment&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
			<span class="n">point</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
	</div>
<div class="viewcode-block" id="BaseSegment.move"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseSegment.move">[docs]</a>	<span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;move the segment&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
			<span class="n">point</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
	</div>
<div class="viewcode-block" id="BaseSegment.scale"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseSegment.scale">[docs]</a>	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;scale the segment&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
			<span class="n">point</span><span class="o">.</span><span class="n">scale</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseSegment.transform"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseSegment.transform">[docs]</a>	<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Transform this segment.</span>
<span class="sd">		Use a Transform matrix object from</span>
<span class="sd">		robofab.transform&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
			<span class="n">p</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
	</div>
	<span class="k">def</span> <span class="nf">_get_onCurve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	
	<span class="k">def</span> <span class="nf">_get_offCurve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		
	<span class="n">offCurve</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_offCurve</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;on curve point for the segment&quot;</span><span class="p">)</span>
	<span class="n">onCurve</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_onCurve</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;list of off curve points for the segment&quot;</span><span class="p">)</span>


		</div>
<div class="viewcode-block" id="BasePoint"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePoint">[docs]</a><span class="k">class</span> <span class="nc">BasePoint</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for point objects.&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c">#RBaseObject.__init__(self)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="bp">False</span>
		
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="s">&quot;unnamed_glyph&quot;</span>
		<span class="n">contourIndex</span> <span class="o">=</span> <span class="s">&quot;unknown_contour&quot;</span>
		<span class="n">segmentIndex</span> <span class="o">=</span> <span class="s">&quot;unknown_segment&quot;</span>
		<span class="n">segmentParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">segmentParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">segmentIndex</span> <span class="o">=</span> <span class="sb">`segmentParent.index`</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
			<span class="n">contourParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">contourParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">contourIndex</span> <span class="o">=</span> <span class="sb">`contourParent.index`</span>
				<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
				<span class="n">glyphParent</span> <span class="o">=</span> <span class="n">contourParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">glyphParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">glyph</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">name</span>
					<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
					<span class="n">fontParent</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
						<span class="k">try</span><span class="p">:</span>
							<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
						<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RPoint for </span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">[</span><span class="si">%s</span><span class="s">][</span><span class="si">%s</span><span class="s">]&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">contourIndex</span><span class="p">,</span> <span class="n">segmentIndex</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c">#mark the object and it&#39;s parent as changed</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
	
<div class="viewcode-block" id="BasePoint.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePoint.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this point&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="n">dont</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;getParent&#39;</span><span class="p">,</span> <span class="s">&#39;offCurve&#39;</span><span class="p">,</span> <span class="s">&#39;onCurve&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dont</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">RBaseObject</span><span class="p">,</span> <span class="n">BaseLib</span><span class="p">)):</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
				<span class="nb">setattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dup</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
</div>
<div class="viewcode-block" id="BasePoint.select"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePoint.select">[docs]</a>	<span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set the selection of this point.</span>
<span class="sd">		XXXX This method should be a lot more versatile, dealing with</span>
<span class="sd">		different kinds of selection, select the bcp&#39;s seperately etc.</span>
<span class="sd">		But that&#39;s for later when we need it more. For now it&#39;s just </span>
<span class="sd">		one flag for the entire thing.&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="n">state</span>
	</div>
<div class="viewcode-block" id="BasePoint.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePoint.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;round the values in the point&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">roundPt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="BasePoint.move"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePoint.move">[docs]</a>	<span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;Move the point&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">addPt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
		</div>
<div class="viewcode-block" id="BasePoint.scale"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePoint.scale">[docs]</a>	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;scale the point&quot;&quot;&quot;</span>
		<span class="n">nX</span><span class="p">,</span> <span class="n">nY</span> <span class="o">=</span> <span class="n">_scalePointFromCenter</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">nX</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">nY</span>
</div>
<div class="viewcode-block" id="BasePoint.transform"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BasePoint.transform">[docs]</a>	<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Transform this point. Use a Transform matrix</span>
<span class="sd">		object from fontTools.misc.transform&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">transformPoint</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="BaseBPoint"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseBPoint">[docs]</a><span class="k">class</span> <span class="nc">BaseBPoint</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>

	<span class="sd">&quot;&quot;&quot;Base class for bPoints objects.&quot;&quot;&quot;</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">RBaseObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="bp">False</span>
		
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="s">&quot;unnamed_glyph&quot;</span>
		<span class="n">contourIndex</span> <span class="o">=</span> <span class="s">&quot;unknown_contour&quot;</span>
		<span class="n">segmentIndex</span> <span class="o">=</span> <span class="s">&quot;unknown_segment&quot;</span>
		<span class="n">segmentParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">segmentParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">segmentIndex</span> <span class="o">=</span> <span class="sb">`segmentParent.index`</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
			<span class="n">contourParent</span> <span class="o">=</span> <span class="n">segmentParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">contourParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">contourIndex</span> <span class="o">=</span> <span class="sb">`contourParent.index`</span>
				<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
				<span class="n">glyphParent</span> <span class="o">=</span> <span class="n">contourParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">glyphParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">glyph</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">name</span>
					<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
					<span class="n">fontParent</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
						<span class="k">try</span><span class="p">:</span>
							<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
						<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RBPoint for </span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">[</span><span class="si">%s</span><span class="s">][</span><span class="si">%s</span><span class="s">][</span><span class="si">%s</span><span class="s">]&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">contourIndex</span><span class="p">,</span> <span class="n">segmentIndex</span><span class="p">,</span> <span class="sb">`self.index`</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c">#mark the object and it&#39;s parent as changed</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
	
<div class="viewcode-block" id="BaseBPoint.select"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseBPoint.select">[docs]</a>	<span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set the selection of this point.</span>
<span class="sd">		XXXX This method should be a lot more versatile, dealing with</span>
<span class="sd">		different kinds of selection, select the bcp&#39;s seperately etc.</span>
<span class="sd">		But that&#39;s for later when we need it more. For now it&#39;s just </span>
<span class="sd">		one flag for the entire thing.&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="n">state</span>
	</div>
<div class="viewcode-block" id="BaseBPoint.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseBPoint.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Round the coordinates to integers&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="n">roundPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anchor</span><span class="p">)</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span> <span class="o">=</span> <span class="n">roundPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_nextSegment</span><span class="p">(</span><span class="n">pSeg</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span> <span class="o">=</span> <span class="n">roundPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span><span class="p">)</span>
	</div>
<div class="viewcode-block" id="BaseBPoint.move"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseBPoint.move">[docs]</a>	<span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;move the bPoint&quot;&quot;&quot;</span>
		<span class="n">bcpIn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span>
		<span class="n">bcpOut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anchor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span> <span class="o">=</span> <span class="n">bcpIn</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_nextSegment</span><span class="p">(</span><span class="n">pSeg</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span> <span class="o">=</span> <span class="n">bcpOut</span>
	</div>
<div class="viewcode-block" id="BaseBPoint.scale"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseBPoint.scale">[docs]</a>	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;scale the bPoint&quot;&quot;&quot;</span>
		<span class="n">centerX</span><span class="p">,</span> <span class="n">centerY</span> <span class="o">=</span> <span class="n">center</span>
		<span class="n">ogCenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">centerX</span><span class="p">,</span> <span class="n">centerY</span><span class="p">)</span>
		<span class="n">scaledCenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">centerX</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">centerY</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
		<span class="n">shiftVal</span> <span class="o">=</span> <span class="p">(</span><span class="n">scaledCenter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ogCenter</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scaledCenter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ogCenter</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">anchor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchor</span>
		<span class="n">bcpIn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span>
		<span class="n">bcpOut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="p">((</span><span class="n">anchor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">shiftVal</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">anchor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">shiftVal</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span> <span class="o">=</span> <span class="p">((</span><span class="n">bcpIn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">bcpIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">))</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_nextSegment</span><span class="p">(</span><span class="n">pSeg</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span> <span class="o">=</span> <span class="p">((</span><span class="n">bcpOut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">bcpOut</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">))</span>
	</div>
<div class="viewcode-block" id="BaseBPoint.transform"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseBPoint.transform">[docs]</a>	<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Transform this point. Use a Transform matrix</span>
<span class="sd">		object from fontTools.misc.transform&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">transformPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anchor</span><span class="p">)</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">transformPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_nextSegment</span><span class="p">(</span><span class="n">pSeg</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">transformPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span><span class="p">)</span>
</div>
	<span class="k">def</span> <span class="nf">_get__anchorPoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span><span class="o">.</span><span class="n">onCurve</span>
	
	<span class="n">_anchorPoint</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get__anchorPoint</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the oncurve point in the parent segment&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_anchor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anchorPoint</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">_set_anchor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">value</span>
		<span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anchorPoint</span>
		<span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
		<span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
		
	<span class="n">anchor</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_anchor</span><span class="p">,</span> <span class="n">_set_anchor</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the position of the anchor&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_bcpIn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="n">pCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">pCount</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="n">p</span> <span class="o">=</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="n">pOn</span> <span class="o">=</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">onCurve</span>
			<span class="k">return</span> <span class="n">relativeBCPIn</span><span class="p">((</span><span class="n">pOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pOn</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">_set_bcpIn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">absoluteBCPIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anchor</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="k">if</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="c">#the user wants to have a bcp leading into the MOVE</span>
			<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
				<span class="c">#we have a straight line between the two anchors</span>
				<span class="k">pass</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c">#we need to insert a new CURVE segment ontop of the move</span>
				<span class="n">contour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
				<span class="c">#set the prev segment outgoing bcp to the onCurve</span>
				<span class="n">prevSeg</span> <span class="o">=</span> <span class="n">contour</span><span class="o">.</span><span class="n">_prevSegment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
				<span class="n">prevOn</span> <span class="o">=</span> <span class="n">prevSeg</span><span class="o">.</span><span class="n">onCurve</span>
				<span class="n">contour</span><span class="o">.</span><span class="n">appendSegment</span><span class="p">(</span><span class="n">CURVE</span><span class="p">,</span> <span class="p">[(</span><span class="n">prevOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">prevOn</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchor</span><span class="p">],</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">pCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">pCount</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
				<span class="c">#if the two points in the offCurvePoints list are located at the</span>
				<span class="c">#anchor coordinates we can switch to a LINE segment type</span>
				<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcpOut</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
					<span class="n">pSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">LINE</span>
					<span class="n">pSeg</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="bp">False</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">pSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
					<span class="n">pSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
			<span class="k">elif</span> <span class="n">value</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
				<span class="n">pSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">CURVE</span>
				<span class="n">pSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
				<span class="n">pSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
			
	<span class="n">bcpIn</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_bcpIn</span><span class="p">,</span> <span class="n">_set_bcpIn</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the (x,y) for the incoming bcp&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_bcpOut</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="n">nextSeg</span> <span class="o">=</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_nextSegment</span><span class="p">(</span><span class="n">pSeg</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="n">nsCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nextSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">nsCount</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="n">p</span> <span class="o">=</span> <span class="n">nextSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">return</span> <span class="n">relativeBCPOut</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anchor</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			
	<span class="k">def</span> <span class="nf">_set_bcpOut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">absoluteBCPOut</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anchor</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="n">nextSeg</span> <span class="o">=</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_nextSegment</span><span class="p">(</span><span class="n">pSeg</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">nextSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOVE</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
				<span class="k">pass</span>
			<span class="k">else</span><span class="p">:</span>				
				<span class="c">#we need to insert a new CURVE segment ontop of the move</span>
				<span class="n">contour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
				<span class="n">nextOn</span> <span class="o">=</span> <span class="n">nextSeg</span><span class="o">.</span><span class="n">onCurve</span>
				<span class="n">contour</span><span class="o">.</span><span class="n">appendSegment</span><span class="p">(</span><span class="n">CURVE</span><span class="p">,</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">nextOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">nextOn</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">nextOn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">nextOn</span><span class="o">.</span><span class="n">y</span><span class="p">)],</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">nsCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nextSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">nsCount</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
				<span class="c">#if the two points in the offCurvePoints list are located at the</span>
				<span class="c">#anchor coordinates we can switch to a LINE segment type</span>
				<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcpIn</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
					<span class="n">nextSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">LINE</span>
					<span class="n">nextSeg</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="bp">False</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">nextSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
					<span class="n">nextSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
			<span class="k">elif</span> <span class="n">value</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
				<span class="n">nextSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">CURVE</span>
				<span class="n">nextSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
				<span class="n">nextSeg</span><span class="o">.</span><span class="n">offCurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
		
	<span class="n">bcpOut</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_bcpOut</span><span class="p">,</span> <span class="n">_set_bcpOut</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the (x,y) for the outgoing bcp&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">pType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span><span class="o">.</span><span class="n">type</span>
		<span class="n">bpType</span> <span class="o">=</span> <span class="n">CORNER</span>
		<span class="k">if</span> <span class="n">pType</span> <span class="o">==</span> <span class="n">CURVE</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
				<span class="n">bpType</span> <span class="o">=</span> <span class="n">CURVE</span>
		<span class="k">return</span> <span class="n">bpType</span>
	
	<span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pointType</span><span class="p">):</span>
		<span class="n">pSeg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentSegment</span>
		<span class="n">segType</span> <span class="o">=</span> <span class="n">pSeg</span><span class="o">.</span><span class="n">type</span>
		<span class="c">#user wants a curve where there is a line</span>
		<span class="k">if</span> <span class="n">pointType</span> <span class="o">==</span> <span class="n">CURVE</span> <span class="ow">and</span> <span class="n">segType</span> <span class="o">==</span> <span class="n">LINE</span><span class="p">:</span>
			<span class="n">pSeg</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">CURVE</span>
			<span class="n">pSeg</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="bp">True</span>
		<span class="c">#the anchor is a curve segment. so, all we need to do is turn the smooth off</span>
		<span class="k">elif</span> <span class="n">pointType</span> <span class="o">==</span> <span class="n">CORNER</span> <span class="ow">and</span> <span class="n">segType</span> <span class="o">==</span> <span class="n">CURVE</span><span class="p">:</span>
			<span class="n">pSeg</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="bp">False</span>

	<span class="nb">type</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_type</span><span class="p">,</span> <span class="n">_set_type</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the type of bPoint, either &#39;corner&#39; or &#39;curve&#39;&quot;</span><span class="p">)</span>

	</div>
<div class="viewcode-block" id="BaseComponent"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseComponent">[docs]</a><span class="k">class</span> <span class="nc">BaseComponent</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all component objects.&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">RBaseObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="bp">False</span>
		
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="s">&quot;unnamed_glyph&quot;</span>
		<span class="n">glyphParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">glyphParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">glyph</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">name</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
			<span class="n">fontParent</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
				<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RComponent for </span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">.components[</span><span class="si">%s</span><span class="s">]&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">glyph</span><span class="p">,</span> <span class="sb">`self.index`</span><span class="p">)</span>
		
	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;mark the object and it&#39;s parent as changed&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
	
<div class="viewcode-block" id="BaseComponent.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseComponent.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this component.&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="n">dont</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;getParent&#39;</span><span class="p">,</span> <span class="s">&#39;_object&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dont</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">RBaseObject</span><span class="p">,</span> <span class="n">BaseLib</span><span class="p">)):</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dup</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
</div>
	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="n">warn</span><span class="p">(</span><span class="s">&quot;Component math has been deprecated and is slated for removal.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
		<span class="c">#Add one Component to another</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">n</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">addPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
		<span class="n">n</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">addPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>

	<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="n">warn</span><span class="p">(</span><span class="s">&quot;Component math has been deprecated and is slated for removal.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
		<span class="c">#Subtract one Component from another</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">n</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">subPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
		<span class="n">n</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">subPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>

	<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
		<span class="n">warn</span><span class="p">(</span><span class="s">&quot;Component math has been deprecated and is slated for removal.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
		<span class="c">#Multiply the Component with factor. Factor can be a tuple of 2 *(f1, f2)</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">n</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">mulPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
		<span class="n">n</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">mulPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
		
	<span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>
	
	<span class="k">def</span> <span class="nf">_get_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">parentGlyph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="c"># the component is an orphan</span>
		<span class="k">if</span> <span class="n">parentGlyph</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span>
		<span class="n">parentFont</span> <span class="o">=</span> <span class="n">parentGlyph</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="c"># the glyph that contains the component</span>
		<span class="c"># does not hae a parent</span>
		<span class="k">if</span> <span class="n">parentFont</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span>
		<span class="c"># the font does not have a glyph</span>
		<span class="c"># that matches the glyph that</span>
		<span class="c"># this component references</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">parentFont</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseGlyph</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">None</span>
		<span class="k">return</span> <span class="n">_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentFont</span><span class="p">)</span>
	
	<span class="n">box</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_box</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;the bounding box of the component: (xMin, yMin, xMax, yMax)&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="BaseComponent.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseComponent.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;round the offset values&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">roundPt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
	</div>
<div class="viewcode-block" id="BaseComponent.draw"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseComponent.draw">[docs]</a>	<span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Segment pen drawing method.&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pen</span><span class="p">,</span> <span class="n">AbstractPen</span><span class="p">):</span>
			<span class="c"># It&#39;s a FontTools pen, which for addComponent is identical</span>
			<span class="c"># to PointPen.</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">drawPoints</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c"># It&#39;s an &quot;old&quot; &#39;Fab pen</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseGlyph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
	</div>
<div class="viewcode-block" id="BaseComponent.drawPoints"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseComponent.drawPoints">[docs]</a>	<span class="k">def</span> <span class="nf">drawPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;draw the object with a point pen&quot;&quot;&quot;</span>
		<span class="n">oX</span><span class="p">,</span> <span class="n">oY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
		<span class="n">sX</span><span class="p">,</span> <span class="n">sY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span>
		<span class="c">#xScale, xyScale, yxScale, yScale, xOffset, yOffset</span>
		<span class="n">pen</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseGlyph</span><span class="p">,</span> <span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">oX</span><span class="p">,</span> <span class="n">oY</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="BaseAnchor"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseAnchor">[docs]</a><span class="k">class</span> <span class="nc">BaseAnchor</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all anchor point objects.&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">RBaseObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="bp">False</span>
	
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">glyph</span> <span class="o">=</span> <span class="s">&quot;unnamed_glyph&quot;</span>
		<span class="n">glyphParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">glyphParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">glyph</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">name</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
			<span class="n">fontParent</span> <span class="o">=</span> <span class="n">glyphParent</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
				<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RAnchor for </span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">.anchors[</span><span class="si">%s</span><span class="s">]&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">glyph</span><span class="p">,</span> <span class="sb">`self.index`</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="n">warn</span><span class="p">(</span><span class="s">&quot;Anchor math has been deprecated and is slated for removal.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
		<span class="c">#Add one anchor to another</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">addPt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">n</span>

	<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="n">warn</span><span class="p">(</span><span class="s">&quot;Anchor math has been deprecated and is slated for removal.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
		<span class="c">#Substract one anchor from another</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">subPt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">n</span>

	<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
		<span class="n">warn</span><span class="p">(</span><span class="s">&quot;Anchor math has been deprecated and is slated for removal.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
		<span class="c">#Multiply the anchor with factor. Factor can be a tuple of 2 *(f1, f2)</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">mulPt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">factor</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
		
	<span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c">#mark the object and it&#39;s parent as changed</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>

<div class="viewcode-block" id="BaseAnchor.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseAnchor.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this anchor.&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="n">dont</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;getParent&#39;</span><span class="p">,</span> <span class="s">&#39;_object&#39;</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dont</span><span class="p">:</span>
				<span class="k">continue</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">RBaseObject</span><span class="p">,</span> <span class="n">BaseLib</span><span class="p">)):</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">dup</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dup</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">n</span>
</div>
<div class="viewcode-block" id="BaseAnchor.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseAnchor.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;round the values in the anchor&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">roundPt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
		</div>
<div class="viewcode-block" id="BaseAnchor.draw"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseAnchor.draw">[docs]</a>	<span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Draw the object onto a segment pen&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pen</span><span class="p">,</span> <span class="n">AbstractPen</span><span class="p">):</span>
			<span class="c"># It&#39;s a FontTools pen</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">moveTo</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">endPath</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c"># It&#39;s an &quot;old&quot; &#39;Fab pen</span>
			<span class="n">pen</span><span class="o">.</span><span class="n">addAnchor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
	</div>
<div class="viewcode-block" id="BaseAnchor.drawPoints"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseAnchor.drawPoints">[docs]</a>	<span class="k">def</span> <span class="nf">drawPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;draw the object with a point pen&quot;&quot;&quot;</span>
		<span class="n">pen</span><span class="o">.</span><span class="n">beginPath</span><span class="p">()</span>
		<span class="n">pen</span><span class="o">.</span><span class="n">addPoint</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">segmentType</span><span class="o">=</span><span class="s">&quot;move&quot;</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
		<span class="n">pen</span><span class="o">.</span><span class="n">endPath</span><span class="p">()</span>
		</div>
<div class="viewcode-block" id="BaseAnchor.move"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseAnchor.move">[docs]</a>	<span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;Move the anchor&quot;&quot;&quot;</span>
		<span class="n">pX</span><span class="p">,</span> <span class="n">pY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="n">pX</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">pY</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
		</div>
<div class="viewcode-block" id="BaseAnchor.scale"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseAnchor.scale">[docs]</a>	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
		<span class="sd">&quot;&quot;&quot;scale the anchor&quot;&quot;&quot;</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">_scalePointFromCenter</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">center</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseAnchor.transform"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseAnchor.transform">[docs]</a>	<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Transform this anchor. Use a Transform matrix</span>
<span class="sd">		object from fontTools.misc.transform&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">transformPoint</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="BaseGuide"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGuide">[docs]</a><span class="k">class</span> <span class="nc">BaseGuide</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all guide objects.&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">RBaseObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="bp">False</span>

</div>
<span class="k">class</span> <span class="nc">BaseInfo</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>

	<span class="n">_baseAttributes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;_object&quot;</span><span class="p">,</span> <span class="s">&quot;changed&quot;</span><span class="p">,</span> <span class="s">&quot;selected&quot;</span><span class="p">,</span> <span class="s">&quot;getParent&quot;</span><span class="p">]</span>
	<span class="n">_deprecatedAttributes</span> <span class="o">=</span> <span class="n">ufoLib</span><span class="o">.</span><span class="n">deprecatedFontInfoAttributesVersion2</span>
	<span class="n">_infoAttributes</span> <span class="o">=</span> <span class="n">ufoLib</span><span class="o">.</span><span class="n">fontInfoAttributesVersion2</span>
	<span class="c"># subclasses may define a list of environment</span>
	<span class="c"># specific attributes that can be retrieved or set.</span>
	<span class="n">_environmentAttributes</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="c"># subclasses may define a list of attributes</span>
	<span class="c"># that should not follow the standard get/set</span>
	<span class="c"># order provided by __setattr__ and __getattr__.</span>
	<span class="c"># for these attributes, the environment specific</span>
	<span class="c"># set and get methods must handle this value</span>
	<span class="c"># without any pre-call validation.</span>
	<span class="c"># (yeah. this is because of some FontLab dumbness.)</span>
	<span class="n">_environmentOverrides</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="c"># check to see if the attribute has been</span>
		<span class="c"># deprecated. if so, warn the caller and</span>
		<span class="c"># update the attribute and value.</span>
		<span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deprecatedAttributes</span><span class="p">:</span>
			<span class="n">newAttr</span><span class="p">,</span> <span class="n">newValue</span> <span class="o">=</span> <span class="n">ufoLib</span><span class="o">.</span><span class="n">convertFontInfoValueForAttributeFromVersion1ToVersion2</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
			<span class="n">note</span> <span class="o">=</span> <span class="s">&quot;The </span><span class="si">%s</span><span class="s"> attribute has been deprecated. Use the new </span><span class="si">%s</span><span class="s"> attribute.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">newAttr</span><span class="p">)</span>
			<span class="n">warn</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
			<span class="n">attr</span> <span class="o">=</span> <span class="n">newAttr</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span>
		<span class="c"># setting a known attribute</span>
		<span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoAttributes</span> <span class="ow">or</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_environmentAttributes</span><span class="p">:</span>
			<span class="c"># lightly test the validity of the value</span>
			<span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
				<span class="n">isValidValue</span> <span class="o">=</span> <span class="n">ufoLib</span><span class="o">.</span><span class="n">validateFontInfoVersion2ValueForAttribute</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">isValidValue</span><span class="p">:</span>
					<span class="k">raise</span> <span class="n">RoboFabError</span><span class="p">(</span><span class="s">&quot;Invalid value (</span><span class="si">%s</span><span class="s">) for attribute (</span><span class="si">%s</span><span class="s">).&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">attr</span><span class="p">))</span>
			<span class="c"># use the environment specific info attr set</span>
			<span class="c"># method if it is defined.</span>
			<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;_environmentSetAttr&quot;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_environmentSetAttr</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
			<span class="c"># fallback to super</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="nb">super</span><span class="p">(</span><span class="n">BaseInfo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		<span class="c"># unknown attribute, test to see if it is a python attr</span>
		<span class="k">elif</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="ow">or</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseAttributes</span><span class="p">:</span>
			<span class="nb">super</span><span class="p">(</span><span class="n">BaseInfo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		<span class="c"># raise an attribute error</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Unknown attribute </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>

	<span class="c"># subclasses with environment specific attr setting can</span>
	<span class="c"># implement this method. __setattr__ will call it if present.</span>
	<span class="c"># def _environmentSetAttr(self, attr, value):</span>
	<span class="c"># 	pass</span>

	<span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_environmentOverrides</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_environmentGetAttr</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
		<span class="c"># check to see if the attribute has been</span>
		<span class="c"># deprecated. if so, warn the caller and</span>
		<span class="c"># flag the value as needing conversion.</span>
		<span class="n">needValueConversionTo1</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deprecatedAttributes</span><span class="p">:</span>
			<span class="n">oldAttr</span> <span class="o">=</span> <span class="n">attr</span>
			<span class="n">oldValue</span> <span class="o">=</span> <span class="n">attr</span>
			<span class="n">newAttr</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ufoLib</span><span class="o">.</span><span class="n">convertFontInfoValueForAttributeFromVersion1ToVersion2</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
			<span class="n">note</span> <span class="o">=</span> <span class="s">&quot;The </span><span class="si">%s</span><span class="s"> attribute has been deprecated. Use the new </span><span class="si">%s</span><span class="s"> attribute.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">newAttr</span><span class="p">)</span>
			<span class="n">warn</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
			<span class="n">attr</span> <span class="o">=</span> <span class="n">newAttr</span>
			<span class="n">needValueConversionTo1</span> <span class="o">=</span> <span class="bp">True</span>
		<span class="c"># getting a known attribute</span>
		<span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoAttributes</span> <span class="ow">or</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_environmentAttributes</span><span class="p">:</span>
			<span class="c"># use the environment specific info attr get</span>
			<span class="c"># method if it is defined.</span>
			<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;_environmentGetAttr&quot;</span><span class="p">):</span>
				<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_environmentGetAttr</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
			<span class="c"># fallback to super</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">value</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">BaseInfo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
				<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
					<span class="k">return</span> <span class="bp">None</span>
			<span class="k">if</span> <span class="n">needValueConversionTo1</span><span class="p">:</span>
				<span class="n">oldAttr</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">ufoLib</span><span class="o">.</span><span class="n">convertFontInfoValueForAttributeFromVersion2ToVersion1</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">value</span>
		<span class="c"># raise an attribute error</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Unknown attribute </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>

		<span class="c"># subclasses with environment specific attr retrieval can</span>
		<span class="c"># implement this method. __getattr__ will call it if present.</span>
		<span class="c"># it should return the requested value.</span>
		<span class="c"># def _environmentGetAttr(self, attr):</span>
		<span class="c"># 	pass</span>

<span class="k">class</span> <span class="nc">BaseFeatures</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">RBaseObject</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

	<span class="k">def</span> <span class="nf">_get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span>

	<span class="k">def</span> <span class="nf">_set_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="n">value</span>

	<span class="n">text</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_text</span><span class="p">,</span> <span class="n">_set_text</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s">&quot;raw feature text.&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="BaseGroups"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGroups">[docs]</a><span class="k">class</span> <span class="nc">BaseGroups</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all RFont.groups objects&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">pass</span>
		
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">fontParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RGroups for </span><span class="si">%s</span><span class="s">&gt;&quot;</span><span class="o">%</span><span class="n">font</span>

<div class="viewcode-block" id="BaseGroups.getParent"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGroups.getParent">[docs]</a>	<span class="k">def</span> <span class="nf">getParent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;this method will be overwritten with a weakref if there is a parent.&quot;&quot;&quot;</span>
		<span class="k">pass</span>
	</div>
	<span class="k">def</span> <span class="nf">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="kn">import</span> <span class="nn">weakref</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;getParent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="c">#override base class to insure proper data is being stored</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">raise</span> <span class="n">RoboFabError</span><span class="p">,</span> <span class="s">&#39;key must be a string&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
			<span class="k">raise</span> <span class="n">RoboFabError</span><span class="p">,</span> <span class="s">&#39;group must be a list&#39;</span>
		<span class="nb">super</span><span class="p">(</span><span class="n">BaseGroups</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		
<div class="viewcode-block" id="BaseGroups.findGlyph"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseGroups.findGlyph">[docs]</a>	<span class="k">def</span> <span class="nf">findGlyph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphName</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return a list of all groups contianing glyphName&quot;&quot;&quot;</span>
		<span class="n">found</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">glyphName</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
				<span class="n">found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">found</span>
		
</div></div>
<div class="viewcode-block" id="BaseLib"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseLib">[docs]</a><span class="k">class</span> <span class="nc">BaseLib</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all lib objects&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">pass</span>
	
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c">#this is a doozy!</span>
		<span class="n">parent</span> <span class="o">=</span> <span class="s">&quot;unknown_parent&quot;</span>
		<span class="n">parentObject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">parentObject</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="c">#do we have a font?</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">parent</span> <span class="o">=</span> <span class="n">parentObject</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
				<span class="c">#or do we have a glyph?</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">parent</span> <span class="o">=</span> <span class="n">parentObject</span><span class="o">.</span><span class="n">name</span>
				<span class="c">#we must be an orphan</span>
				<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RLib for </span><span class="si">%s</span><span class="s">&gt;&quot;</span><span class="o">%</span><span class="n">parent</span>

<div class="viewcode-block" id="BaseLib.getParent"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseLib.getParent">[docs]</a>	<span class="k">def</span> <span class="nf">getParent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;this method will be overwritten with a weakref if there is a parent.&quot;&quot;&quot;</span>
		<span class="k">pass</span>
	</div>
	<span class="k">def</span> <span class="nf">setParent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="kn">import</span> <span class="nn">weakref</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;getParent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

<div class="viewcode-block" id="BaseLib.copy"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseLib.copy">[docs]</a>	<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aParent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Duplicate this lib.&quot;&quot;&quot;</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">aParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">aParent</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">n</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">())</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">n</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">n</span>
	
		</div></div>
<div class="viewcode-block" id="BaseKerning"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning">[docs]</a><span class="k">class</span> <span class="nc">BaseKerning</span><span class="p">(</span><span class="n">RBaseObject</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;Base class for all kerning objects. Object behaves like a dict but has</span>
<span class="sd">	some special kerning specific tricks.&quot;&quot;&quot;</span>
	
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kerningDict</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">kerningDict</span><span class="p">:</span>
			<span class="n">kerningDict</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span> <span class="o">=</span> <span class="n">kerningDict</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>		<span class="c"># if the object needs to be saved</span>
	
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">font</span> <span class="o">=</span> <span class="s">&quot;unnamed_font&quot;</span>
		<span class="n">fontParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">fontParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">font</span> <span class="o">=</span> <span class="n">fontParent</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">postscriptFullName</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">return</span> <span class="s">&quot;&lt;RKerning for </span><span class="si">%s</span><span class="s">&gt;&quot;</span><span class="o">%</span><span class="n">font</span>
			
	<span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="n">pair</span> <span class="o">=</span> <span class="n">key</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">raise</span> <span class="n">RoboFabError</span><span class="p">,</span> <span class="s">&#39;kerning pair must be a tuple: (left, right)&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">key</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
				<span class="k">raise</span> <span class="ne">IndexError</span>
			<span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
			<span class="n">pair</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">pair</span><span class="p">):</span>
			<span class="k">raise</span> <span class="ne">IndexError</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">pair</span>
	
	<span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pair</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="k">raise</span> <span class="n">RoboFabError</span><span class="p">,</span> <span class="s">&#39;kerning pair must be a tuple: (left, right)&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
				<span class="k">raise</span> <span class="n">RoboFabError</span><span class="p">,</span> <span class="s">&#39;kerning pair must be a tuple: (left, right)&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
						<span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
		
	<span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		
	<span class="k">def</span> <span class="nf">_hasChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;mark the object and it&#39;s parent as changed&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">setChanged</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">getParent</span><span class="p">()</span><span class="o">.</span><span class="n">_hasChanged</span><span class="p">()</span>
	
<div class="viewcode-block" id="BaseKerning.keys"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.keys">[docs]</a>	<span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return list of kerning pairs&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		</div>
<div class="viewcode-block" id="BaseKerning.values"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.values">[docs]</a>	<span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return a list of kerning values&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
	</div>
<div class="viewcode-block" id="BaseKerning.items"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.items">[docs]</a>	<span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return a list of kerning items&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
	</div>
	<span class="k">def</span> <span class="nf">has_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pair</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
	
<div class="viewcode-block" id="BaseKerning.get"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.get">[docs]</a>	<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pair</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;get a value. return None if the pair does not exist&quot;&quot;&quot;</span>
		<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">value</span>
		</div>
<div class="viewcode-block" id="BaseKerning.remove"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.remove">[docs]</a>	<span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pair</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;remove a kerning pair&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
	</div>
<div class="viewcode-block" id="BaseKerning.getAverage"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.getAverage">[docs]</a>	<span class="k">def</span> <span class="nf">getAverage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return average of all kerning pairs&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">return</span> <span class="mi">0</span>
		<span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="n">i</span>
		<span class="k">return</span> <span class="n">value</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
	</div>
<div class="viewcode-block" id="BaseKerning.getExtremes"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.getExtremes">[docs]</a>	<span class="k">def</span> <span class="nf">getExtremes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return the lowest and highest kerning values&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">return</span> <span class="mi">0</span>
		<span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
		<span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">values</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span> 
		<span class="k">return</span> <span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		</div>
<div class="viewcode-block" id="BaseKerning.update"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kerningDict</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;replace kerning data with the data in the given kerningDict&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">kerningDict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="n">kerningDict</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>
	</div>
<div class="viewcode-block" id="BaseKerning.clear"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.clear">[docs]</a>	<span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;clear all kerning&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span> <span class="o">=</span> <span class="p">{}</span>
		</div>
<div class="viewcode-block" id="BaseKerning.add"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.add">[docs]</a>	<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;add value to all kerning pairs&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">+</span> <span class="n">value</span>
		</div>
<div class="viewcode-block" id="BaseKerning.scale"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.scale">[docs]</a>	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;scale all kernng pairs by value&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">*</span> <span class="n">value</span>
			</div>
<div class="viewcode-block" id="BaseKerning.minimize"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.minimize">[docs]</a>	<span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;eliminate pairs with value less than minimum&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">minimum</span><span class="p">:</span>
				<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
	</div>
<div class="viewcode-block" id="BaseKerning.eliminate"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.eliminate">[docs]</a>	<span class="k">def</span> <span class="nf">eliminate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leftGlyphsToEliminate</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rightGlyphsToEliminate</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">analyzeOnly</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;eliminate pairs containing a left glyph that is in the leftGlyphsToEliminate list</span>
<span class="sd">		or a right glyph that is in the rightGlyphsToELiminate list.</span>
<span class="sd">		sideGlyphsToEliminate can be a string: &#39;a&#39; or list: [&#39;a&#39;, &#39;b&#39;].</span>
<span class="sd">		analyzeOnly will not remove pairs. it will return a count</span>
<span class="sd">		of all pairs that would be removed.&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
			<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">lgte</span> <span class="o">=</span> <span class="n">leftGlyphsToEliminate</span>
		<span class="n">rgte</span> <span class="o">=</span> <span class="n">rightGlyphsToEliminate</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lgte</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="n">lgte</span> <span class="o">=</span> <span class="p">[</span><span class="n">lgte</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rgte</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="n">rgte</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgte</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">pair</span>
			<span class="k">if</span> <span class="n">left</span> <span class="ow">in</span> <span class="n">lgte</span> <span class="ow">or</span> <span class="n">right</span> <span class="ow">in</span> <span class="n">rgte</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
					<span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">count</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span>
				</div>
<div class="viewcode-block" id="BaseKerning.interpolate"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.interpolate">[docs]</a>	<span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourceDictOne</span><span class="p">,</span> <span class="n">sourceDictTwo</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">clearExisting</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;interpolate the kerning between sourceDictOne</span>
<span class="sd">		and sourceDictTwo. clearExisting will clear existing</span>
<span class="sd">		kerning first.&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">sets</span> <span class="kn">import</span> <span class="n">Set</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="c"># in case the value is a x, y tuple: use the x only.</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">clearExisting</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="n">pairs</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">sourceDictOne</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="n">Set</span><span class="p">(</span><span class="n">sourceDictTwo</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
			<span class="n">s1</span> <span class="o">=</span> <span class="n">sourceDictOne</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">s2</span> <span class="o">=</span> <span class="n">sourceDictTwo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="n">_interpolate</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
	</div>
<div class="viewcode-block" id="BaseKerning.round"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.round">[docs]</a>	<span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;round the kerning pair values to increments of multiple&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>
			<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">multiple</span><span class="p">)))</span> <span class="o">*</span> <span class="n">multiple</span>
	</div>
<div class="viewcode-block" id="BaseKerning.occurrenceCount"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.occurrenceCount">[docs]</a>	<span class="k">def</span> <span class="nf">occurrenceCount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphsToCount</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return a dict with glyphs as keys and the number of </span>
<span class="sd">		occurances of that glyph in the kerning pairs as the value</span>
<span class="sd">		glyphsToCount can be a string: &#39;a&#39; or list: [&#39;a&#39;, &#39;b&#39;]&quot;&quot;&quot;</span>
		<span class="n">gtc</span> <span class="o">=</span> <span class="n">glyphsToCount</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gtc</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="n">gtc</span> <span class="o">=</span> <span class="p">[</span><span class="n">gtc</span><span class="p">]</span>
		<span class="n">gtcDict</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="n">gtc</span><span class="p">:</span>
			<span class="n">gtcDict</span><span class="p">[</span><span class="n">glyph</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">pair</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">gtcDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">left</span><span class="p">):</span>
				<span class="n">gtcDict</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">gtcDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
				<span class="n">gtcDict</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">gtcDict</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">gtcDict</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
			<span class="n">gtcDict</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">=</span> <span class="n">gtcDict</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="n">found</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">glyphName</span> <span class="ow">in</span> <span class="n">gtc</span><span class="p">:</span>
			<span class="n">found</span><span class="p">[</span><span class="n">glyphName</span><span class="p">]</span> <span class="o">=</span> <span class="n">gtcDict</span><span class="p">[</span><span class="n">glyphName</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">found</span>
	</div>
<div class="viewcode-block" id="BaseKerning.getLeft"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.getLeft">[docs]</a>	<span class="k">def</span> <span class="nf">getLeft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphName</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Return a list of kerns with glyphName as left character.&quot;&quot;&quot;</span>
		<span class="n">hits</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">glyphName</span><span class="p">:</span>
				<span class="n">hits</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">hits</span>
				</div>
<div class="viewcode-block" id="BaseKerning.getRight"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.getRight">[docs]</a>	<span class="k">def</span> <span class="nf">getRight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">glyphName</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Return a list of kerns with glyphName as left character.&quot;&quot;&quot;</span>
		<span class="n">hits</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">glyphName</span><span class="p">:</span>
				<span class="n">hits</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">hits</span>
		</div>
<div class="viewcode-block" id="BaseKerning.combine"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.combine">[docs]</a>	<span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kerningDicts</span><span class="p">,</span> <span class="n">overwriteExisting</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;combine two or more kerning dictionaries.</span>
<span class="sd">		overwrite exsisting duplicate pairs if overwriteExisting=True&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kerningDicts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
			<span class="n">kerningDicts</span> <span class="o">=</span> <span class="p">[</span><span class="n">kerningDicts</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">kd</span> <span class="ow">in</span> <span class="n">kerningDicts</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">kd</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">exists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">exists</span> <span class="ow">and</span> <span class="n">overwriteExisting</span><span class="p">:</span>
					<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="n">kd</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>
				<span class="k">elif</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
					<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="n">kd</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>
					</div>
<div class="viewcode-block" id="BaseKerning.swapNames"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.swapNames">[docs]</a>	<span class="k">def</span> <span class="nf">swapNames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">swapTable</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;change glyph names in all kerning pairs based on swapTable.</span>
<span class="sd">		swapTable = {&#39;BeforeName&#39;:&#39;AfterName&#39;, ...}&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">foundInstance</span> <span class="o">=</span> <span class="bp">False</span>
			<span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">pair</span>
			<span class="k">if</span> <span class="n">swapTable</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">left</span><span class="p">):</span>
				<span class="n">left</span> <span class="o">=</span> <span class="n">swapTable</span><span class="p">[</span><span class="n">left</span><span class="p">]</span>
				<span class="n">foundInstance</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">if</span> <span class="n">swapTable</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
				<span class="n">right</span> <span class="o">=</span> <span class="n">swapTable</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>
				<span class="n">foundInstance</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">if</span> <span class="n">foundInstance</span><span class="p">:</span>
				<span class="bp">self</span><span class="p">[(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>
				<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
				</div>
<div class="viewcode-block" id="BaseKerning.explodeClasses"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.explodeClasses">[docs]</a>	<span class="k">def</span> <span class="nf">explodeClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leftClassDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rightClassDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">analyzeOnly</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;turn class kerns into real kerning pairs. classes should</span>
<span class="sd">		be defined in dicts: {&#39;O&#39;:[&#39;C&#39;, &#39;G&#39;, &#39;Q&#39;], &#39;H&#39;:[&#39;B&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;I&#39;]}.</span>
<span class="sd">		analyzeOnly will not remove pairs. it will return a count</span>
<span class="sd">		of all pairs that would be added&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">leftClassDict</span><span class="p">:</span>
			<span class="n">leftClassDict</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">rightClassDict</span><span class="p">:</span>
			<span class="n">rightClassDict</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
			<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">pair</span>
			<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">leftClassDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rightClassDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
				<span class="n">allLeft</span> <span class="o">=</span> <span class="n">leftClassDict</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">left</span><span class="p">]</span>
				<span class="n">allRight</span> <span class="o">=</span> <span class="n">rightClassDict</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">right</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">leftSub</span> <span class="ow">in</span> <span class="n">allLeft</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">rightSub</span> <span class="ow">in</span> <span class="n">allRight</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
							<span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="bp">self</span><span class="p">[(</span><span class="n">leftSub</span><span class="p">,</span> <span class="n">rightSub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
			<span class="k">elif</span> <span class="n">leftClassDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">rightClassDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
				<span class="n">allLeft</span> <span class="o">=</span> <span class="n">leftClassDict</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">left</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">leftSub</span> <span class="ow">in</span> <span class="n">allLeft</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
						<span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="bp">self</span><span class="p">[(</span><span class="n">leftSub</span><span class="p">,</span> <span class="n">right</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
			<span class="k">elif</span> <span class="n">rightClassDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">right</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">leftClassDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">left</span><span class="p">):</span>
				<span class="n">allRight</span> <span class="o">=</span> <span class="n">rightClassDict</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">right</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">rightSub</span> <span class="ow">in</span> <span class="n">allRight</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
						<span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="bp">self</span><span class="p">[(</span><span class="n">left</span><span class="p">,</span> <span class="n">rightSub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">count</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span>
					</div>
<div class="viewcode-block" id="BaseKerning.implodeClasses"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.implodeClasses">[docs]</a>	<span class="k">def</span> <span class="nf">implodeClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leftClassDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rightClassDict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">analyzeOnly</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;condense the number of kerning pairs by applying classes.</span>
<span class="sd">		this will eliminate all pairs containg the classed glyphs leaving</span>
<span class="sd">		pairs that contain the key glyphs behind. analyzeOnly will not</span>
<span class="sd">		remove pairs. it will return a count of all pairs that would be removed.&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">leftClassDict</span><span class="p">:</span>
			<span class="n">leftClassDict</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">rightClassDict</span><span class="p">:</span>
			<span class="n">rightClassDict</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">leftImplode</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">rightImplode</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">leftClassDict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
			<span class="n">leftImplode</span> <span class="o">=</span> <span class="n">leftImplode</span> <span class="o">+</span> <span class="n">value</span>
		<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">rightClassDict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
			<span class="n">rightImplode</span> <span class="o">=</span> <span class="n">rightImplode</span> <span class="o">+</span> <span class="n">value</span>
		<span class="n">analyzed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminate</span><span class="p">(</span><span class="n">leftGlyphsToEliminate</span><span class="o">=</span><span class="n">leftImplode</span><span class="p">,</span> <span class="n">rightGlyphsToEliminate</span><span class="o">=</span><span class="n">rightImplode</span><span class="p">,</span> <span class="n">analyzeOnly</span><span class="o">=</span><span class="n">analyzeOnly</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">analyzeOnly</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">analyzed</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span>
		</div>
<div class="viewcode-block" id="BaseKerning.importAFM"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.importAFM">[docs]</a>	<span class="k">def</span> <span class="nf">importAFM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">clearExisting</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Import kerning pairs from an AFM file. clearExisting=True will</span>
<span class="sd">		clear all exising kerning&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">fontTools.afmLib</span> <span class="kn">import</span> <span class="n">AFM</span>
		<span class="c">#a nasty hack to fix line ending problems</span>
		<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>
		<span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="c">#/nasty hack</span>
		<span class="n">kerning</span> <span class="o">=</span> <span class="n">AFM</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">_kerning</span>
		<span class="k">if</span> <span class="n">clearExisting</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">kerning</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="n">kerning</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>	
				</div>
<div class="viewcode-block" id="BaseKerning.asDict"><a class="viewcode-back" href="../../../objects/objectsBase.html#robofab.objects.objectsBase.BaseKerning.asDict">[docs]</a>	<span class="k">def</span> <span class="nf">asDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">returnIntegers</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;return the object as a dictionary&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">returnIntegers</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kerning</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c">#duplicate the kerning dict so that we aren&#39;t destroying it</span>
			<span class="n">kerning</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">kerning</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">pair</span><span class="p">]))</span>
			<span class="k">return</span> <span class="n">kerning</span>
</div>
	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="kn">from</span> <span class="nn">sets</span> <span class="kn">import</span> <span class="n">Set</span>
		<span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="n">k</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="n">Set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
			<span class="n">new</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">new</span>
	
	<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="kn">from</span> <span class="nn">sets</span> <span class="kn">import</span> <span class="n">Set</span>
		<span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="n">k</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="n">Set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
			<span class="n">new</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">new</span>

	<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
		<span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">new</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">factor</span>
		<span class="k">return</span> <span class="n">new</span>
	
	<span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

	<span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ZeroDivisionError</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mul__</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">factor</span><span class="p">)</span>
	</div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">RoboFab 1.3.0a documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Tal Leming, Erik van Blokland, Just van Rossum.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.
    </div>
  </body>
</html>